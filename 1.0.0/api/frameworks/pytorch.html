
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/UnicoLab/MLPotion/1.0.0/api/frameworks/pytorch.html">
      
      
        <link rel="prev" href="tensorflow.html">
      
      
        <link rel="next" href="keras.html">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>PyTorch - MLPotion - Machine Learning Potion</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pytorch-api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="MLPotion - Machine Learning Potion" class="md-header__button md-logo" aria-label="MLPotion - Machine Learning Potion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MLPotion - Machine Learning Potion
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PyTorch
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/UnicoLab/MLPotion" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ML-Potion
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="MLPotion - Machine Learning Potion" class="md-nav__button md-logo" aria-label="MLPotion - Machine Learning Potion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    MLPotion - Machine Learning Potion
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UnicoLab/MLPotion" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ML-Potion
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üè† Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üöÄ Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    üöÄ Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/concepts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üîß Frameworks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    üîß Frameworks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frameworks/tensorflow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TensorFlow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frameworks/pytorch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frameworks/keras.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keras
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üîÑ Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    üîÑ Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/zenml.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZenML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üéì Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    üéì Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basic-pipeline.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/zenml-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZenML Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/multi-framework.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üìñ API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    üìñ API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tensorflow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TensorFlow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="pytorch.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Loading
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        datasets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        StreamingCSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StreamingCSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders" class="md-nav__link">
    <span class="md-ellipsis">
      
        loaders
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loaders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataLoader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        StreamingCSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StreamingCSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    <span class="md-ellipsis">
      
        Training
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers" class="md-nav__link">
    <span class="md-ellipsis">
      
        trainers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="trainers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers.ModelTrainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelTrainer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers.ModelTrainer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers.ModelTrainer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        train()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluators
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="evaluators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelEvaluator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator.evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Persistence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        persistence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelPersistence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelPersistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.path_obj" class="md-nav__link">
    <span class="md-ellipsis">
      
        path_obj
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#export" class="md-nav__link">
    <span class="md-ellipsis">
      
        Export
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters" class="md-nav__link">
    <span class="md-ellipsis">
      
        exporters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="exporters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelExporter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelExporter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter.export" class="md-nav__link">
    <span class="md-ellipsis">
      
        export()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="keras.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keras
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/zenml.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZenML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ü§ù Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    ü§ù Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-loading" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Loading
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets" class="md-nav__link">
    <span class="md-ellipsis">
      
        datasets
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        StreamingCSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StreamingCSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders" class="md-nav__link">
    <span class="md-ellipsis">
      
        loaders
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loaders">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataLoader
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataLoader">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        CSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __getitem__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __len__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        StreamingCSVDataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StreamingCSVDataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset.__iter__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __iter__()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __post_init__()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training" class="md-nav__link">
    <span class="md-ellipsis">
      
        Training
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers" class="md-nav__link">
    <span class="md-ellipsis">
      
        trainers
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="trainers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers.ModelTrainer" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelTrainer
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelTrainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers.ModelTrainer-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.training.trainers.ModelTrainer.train" class="md-nav__link">
    <span class="md-ellipsis">
      
        train()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Evaluation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluators
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="evaluators">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelEvaluator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelEvaluator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator.evaluate" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Persistence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        persistence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="persistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelPersistence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelPersistence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Attributes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.path_obj" class="md-nav__link">
    <span class="md-ellipsis">
      
        path_obj
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#export" class="md-nav__link">
    <span class="md-ellipsis">
      
        Export
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters" class="md-nav__link">
    <span class="md-ellipsis">
      
        exporters
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="exporters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter" class="md-nav__link">
    <span class="md-ellipsis">
      
        ModelExporter
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ModelExporter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter.export" class="md-nav__link">
    <span class="md-ellipsis">
      
        export()
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="pytorch-api-reference">PyTorch API Reference üìñ</h1>
<p>Complete API reference for MLPotion's PyTorch components.</p>
<div class="admonition info">
<p class="admonition-title">Auto-Generated Documentation</p>
<p>This page is automatically populated with API documentation from the source code.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Extensibility</p>
<p>These components are built using protocol-based design, making MLPotion easy to extend. Want to add new data sources, training methods, or integrations? See <a href="../../contributing/overview.html">Contributing Guide</a>.</p>
</div>
<h2 id="data-loading">Data Loading</h2>


<div class="doc doc-object doc-module">



<h2 id="mlpotion.frameworks.pytorch.data.datasets" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">mlpotion.frameworks.pytorch.data.datasets</span>


</h2>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">






<h3 id="mlpotion.frameworks.pytorch.data.datasets-classes">Classes</h3>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.data.datasets.CSVDataset" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">CSVDataset</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="torch.utils.data.Dataset">Dataset</span>[tuple[torch.<span title="torch.Tensor">Tensor</span>, torch.<span title="torch.Tensor">Tensor</span>] | torch.<span title="torch.Tensor">Tensor</span>]</code></p>

  
      <p>PyTorch Dataset for CSV files with on-demand tensor conversion.</p>
<p>This class loads CSV data into memory (using Pandas) and provides a map-style PyTorch Dataset.
It supports filtering columns, separating labels, and efficient on-demand tensor conversion
to minimize memory usage.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_pattern</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Glob pattern matching the CSV files to load.</p></td>
        </tr>
        <tr>
          <td><code>column_names</code></td>
          <td>
                <code>list[str] | None</code>
          </td>
          <td><p>Specific columns to load. If None, all columns are loaded.</p></td>
        </tr>
        <tr>
          <td><code>label_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td><p>Name of the column to use as the label. If None, no labels are returned.</p></td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>torch.<span title="torch.dtype">dtype</span></code>
          </td>
          <td><p>The data type for the features (default: <code>torch.float32</code>).</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>

<span class="c1"># Create dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">CSVDataset</span><span class="p">(</span>
    <span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;data/train_*.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target_class&quot;</span><span class="p">,</span>
    <span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feature1&quot;</span><span class="p">,</span> <span class="s2">&quot;feature2&quot;</span><span class="p">,</span> <span class="s2">&quot;target_class&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Create DataLoader</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Iterate</span>
<span class="k">for</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.data.datasets.CSVDataset-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__getitem__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__getitem__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="fm">__getitem__</span><span class="p">(</span>
    <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get item at index.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>idx</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Global row index.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[torch.<span title="torch.Tensor">Tensor</span>, torch.<span title="torch.Tensor">Tensor</span>] | torch.<span title="torch.Tensor">Tensor</span></code>
          </td>
          <td><p>(features, label) tuple if labels exist, else just features.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/datasets.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get item at index.</span>

<span class="sd">    Args:</span>
<span class="sd">        idx: Global row index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (features, label) tuple if labels exist, else just features.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Dataset is empty or not properly initialized.&quot;</span><span class="p">)</span>

    <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="c1"># Convert to numpy array and then to tensor</span>
    <span class="n">features_np</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">features_np</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">label_val</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">label</span>

    <span class="k">return</span> <span class="n">features</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__len__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__len__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="fm">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return dataset length.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/datasets.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return dataset length.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.datasets.CSVDataset.__post_init__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__post_init__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">__post_init__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Eagerly load CSV files into a DataFrame and validate configuration.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/datasets.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eagerly load CSV files into a DataFrame and validate configuration.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_files</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_dataframe</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_features_labels</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Initialized CSVDataset with &quot;</span>
            <span class="s2">&quot;n_rows=</span><span class="si">{rows}</span><span class="s2">, n_features=</span><span class="si">{features}</span><span class="s2">, labels=</span><span class="si">{labels}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">rows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_feature_cols</span><span class="p">),</span>
            <span class="n">labels</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">DataLoadingError</span><span class="p">:</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
        <span class="k">raise</span> <span class="n">DataLoadingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load CSV dataset: </span><span class="si">{</span><span class="n">exc</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">StreamingCSVDataset</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="torch.utils.data.IterableDataset">IterableDataset</span>[tuple[torch.<span title="torch.Tensor">Tensor</span>, torch.<span title="torch.Tensor">Tensor</span>] | torch.<span title="torch.Tensor">Tensor</span>]</code></p>

  
      <p>Streaming PyTorch IterableDataset for large CSV files.</p>
<p>This dataset is designed for datasets that are too large to fit in memory. It reads CSV files
in chunks (using Pandas) and streams samples one by one. It is compatible with PyTorch's
<code>IterableDataset</code> interface.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_pattern</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Glob pattern matching the CSV files to load.</p></td>
        </tr>
        <tr>
          <td><code>column_names</code></td>
          <td>
                <code>list[str] | None</code>
          </td>
          <td><p>Specific columns to load.</p></td>
        </tr>
        <tr>
          <td><code>label_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td><p>Name of the label column.</p></td>
        </tr>
        <tr>
          <td><code>chunksize</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of rows to read into memory at a time per file.</p></td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>torch.<span title="torch.dtype">dtype</span></code>
          </td>
          <td><p>The data type for the features.</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">StreamingCSVDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>

<span class="c1"># Create streaming dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">StreamingCSVDataset</span><span class="p">(</span>
    <span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;data/large_dataset_*.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">)</span>

<span class="c1"># Create DataLoader (shuffle must be False for IterableDataset)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>

<span class="k">for</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
    <span class="c1"># Train model...</span>
    <span class="k">pass</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset.__iter__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__iter__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="fm">__iter__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
    <span class="n">Iterator</span><span class="p">[</span>
        <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Yield samples one by one across all CSV files.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/datasets.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield samples one by one across all CSV files.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Streaming CSV file: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Use pandas chunked reading</span>
            <span class="n">chunk_iter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                <span class="n">file_path</span><span class="p">,</span>
                <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">,</span>
                <span class="n">chunksize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunksize</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># If usecols=None is not accepted by some pandas version</span>
            <span class="n">chunk_iter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                <span class="n">file_path</span><span class="p">,</span>
                <span class="n">chunksize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunksize</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">chunk_df</span> <span class="ow">in</span> <span class="n">chunk_iter</span><span class="p">:</span>
            <span class="c1"># Validate label column if needed</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chunk_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">DataLoadingError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Label column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="si">}</span><span class="s2">&#39; not found in &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> (columns: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">chunk_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="p">)</span>
                <span class="n">labels_np</span> <span class="o">=</span> <span class="n">chunk_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="n">features_df</span> <span class="o">=</span> <span class="n">chunk_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels_np</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">features_df</span> <span class="o">=</span> <span class="n">chunk_df</span>

            <span class="c1"># Convert whole chunk to numpy once</span>
            <span class="n">features_np</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">labels_np</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">features_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span>
                        <span class="n">features_np</span><span class="p">[</span><span class="n">row_idx</span><span class="p">],</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">labels_np</span><span class="p">[</span><span class="n">row_idx</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">features_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span>
                        <span class="n">features_np</span><span class="p">[</span><span class="n">row_idx</span><span class="p">],</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">yield</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.datasets.StreamingCSVDataset.__post_init__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__post_init__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">__post_init__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Resolve files eagerly and log basic configuration.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/datasets.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolve files eagerly and log basic configuration.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_files</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Initialized StreamingCSVDataset with </span><span class="si">{n_files}</span><span class="s2"> file(s), &quot;</span>
        <span class="s2">&quot;chunksize=</span><span class="si">{chunksize}</span><span class="s2">, label_name=</span><span class="si">{label}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">n_files</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span>
        <span class="n">chunksize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunksize</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="mlpotion.frameworks.pytorch.data.loaders" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">mlpotion.frameworks.pytorch.data.loaders</span>


</h2>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">






<h3 id="mlpotion.frameworks.pytorch.data.loaders-classes">Classes</h3>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">CSVDataLoader</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="typing.Generic">Generic</span>[<span title="mlpotion.frameworks.pytorch.data.loaders.T_co">T_co</span>]</code></p>

  
      <p>Factory for creating configured PyTorch DataLoaders.</p>
<p>This class simplifies the creation of <code>torch.utils.data.DataLoader</code> instances by
encapsulating common configuration options and handling differences between
map-style and iterable datasets (e.g., automatically disabling shuffling for iterables).</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>batch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of samples per batch.</p></td>
        </tr>
        <tr>
          <td><code>shuffle</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to shuffle the data (ignored for IterableDatasets).</p></td>
        </tr>
        <tr>
          <td><code>num_workers</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of subprocesses to use for data loading.</p></td>
        </tr>
        <tr>
          <td><code>pin_memory</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to copy tensors into CUDA pinned memory.</p></td>
        </tr>
        <tr>
          <td><code>drop_last</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to drop the last incomplete batch.</p></td>
        </tr>
        <tr>
          <td><code>persistent_workers</code></td>
          <td>
                <code>bool | None</code>
          </td>
          <td><p>Whether to keep workers alive between epochs.</p></td>
        </tr>
        <tr>
          <td><code>prefetch_factor</code></td>
          <td>
                <code>int | None</code>
          </td>
          <td><p>Number of batches loaded in advance by each worker.</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVDataLoader</span><span class="p">,</span> <span class="n">CSVDataset</span>

<span class="c1"># 1. Create a dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">CSVDataset</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">)</span>

<span class="c1"># 2. Configure the loader factory</span>
<span class="n">loader_factory</span> <span class="o">=</span> <span class="n">CSVDataLoader</span><span class="p">(</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">pin_memory</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># 3. Create the actual DataLoader</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">loader_factory</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>

<span class="c1"># 4. Use it</span>
<span class="k">for</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
    <span class="o">...</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataLoader.load" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">load</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">load</span><span class="p">(</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">[</span><span class="n">T_co</span><span class="p">]</span> <span class="o">|</span> <span class="n">IterableDataset</span><span class="p">[</span><span class="n">T_co</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">T_co</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Load a configured :class:<code>DataLoader</code> from a dataset.</p>
<p>This method is aware of :class:<code>IterableDataset</code> vs map-style
:class:<code>Dataset</code> and will:</p>
<ul>
<li>Disable shuffling for iterable datasets (with a warning if
  <code>shuffle=True</code> was requested).</li>
<li>Apply worker-related options only when valid.</li>
</ul>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dataset</code></td>
          <td>
                <code><span title="torch.utils.data.Dataset">Dataset</span>[<span title="mlpotion.frameworks.pytorch.data.loaders.T_co">T_co</span>] | <span title="torch.utils.data.IterableDataset">IterableDataset</span>[<span title="mlpotion.frameworks.pytorch.data.loaders.T_co">T_co</span>]</code>
          </td>
          <td><p>PyTorch :class:<code>Dataset</code> or :class:<code>IterableDataset</code>.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>Configured</code></td>          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span>[<span title="mlpotion.frameworks.pytorch.data.loaders.T_co">T_co</span>]</code>
          </td>
          <td><p>class:<code>torch.utils.data.DataLoader</code> instance.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trycatch</span><span class="p">(</span>
    <span class="n">error</span><span class="o">=</span><span class="n">DataLoadingError</span><span class="p">,</span>
    <span class="n">success_msg</span><span class="o">=</span><span class="s2">&quot;‚úÖ Successfully Loading data&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">dataset</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">[</span><span class="n">T_co</span><span class="p">]</span> <span class="o">|</span> <span class="n">IterableDataset</span><span class="p">[</span><span class="n">T_co</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">T_co</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a configured :class:`DataLoader` from a dataset.</span>

<span class="sd">    This method is aware of :class:`IterableDataset` vs map-style</span>
<span class="sd">    :class:`Dataset` and will:</span>

<span class="sd">    - Disable shuffling for iterable datasets (with a warning if</span>
<span class="sd">      ``shuffle=True`` was requested).</span>
<span class="sd">    - Apply worker-related options only when valid.</span>

<span class="sd">    Args:</span>
<span class="sd">        dataset: PyTorch :class:`Dataset` or :class:`IterableDataset`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Configured :class:`torch.utils.data.DataLoader` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_iterable</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">IterableDataset</span><span class="p">)</span>
    <span class="n">effective_shuffle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_shuffle</span><span class="p">(</span><span class="n">is_iterable</span><span class="o">=</span><span class="n">is_iterable</span><span class="p">)</span>

    <span class="n">loader_kwargs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_loader_kwargs</span><span class="p">(</span>
        <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="n">effective_shuffle</span><span class="p">,</span>
        <span class="n">is_iterable</span><span class="o">=</span><span class="n">is_iterable</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Creating DataLoader with config: &quot;</span>
        <span class="s2">&quot;batch_size=</span><span class="si">{batch_size}</span><span class="s2">, shuffle=</span><span class="si">{shuffle}</span><span class="s2">, &quot;</span>
        <span class="s2">&quot;num_workers=</span><span class="si">{num_workers}</span><span class="s2">, pin_memory=</span><span class="si">{pin_memory}</span><span class="s2">, &quot;</span>
        <span class="s2">&quot;drop_last=</span><span class="si">{drop_last}</span><span class="s2">, persistent_workers=</span><span class="si">{persistent_workers}</span><span class="s2">, &quot;</span>
        <span class="s2">&quot;prefetch_factor=</span><span class="si">{prefetch_factor}</span><span class="s2">, dataset_type=</span><span class="si">{dtype}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="n">effective_shuffle</span><span class="p">,</span>
        <span class="n">num_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_workers</span><span class="p">,</span>
        <span class="n">pin_memory</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pin_memory</span><span class="p">,</span>
        <span class="n">drop_last</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">drop_last</span><span class="p">,</span>
        <span class="n">persistent_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">persistent_workers</span><span class="p">,</span>
        <span class="n">prefetch_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prefetch_factor</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;IterableDataset&quot;</span> <span class="k">if</span> <span class="n">is_iterable</span> <span class="k">else</span> <span class="s2">&quot;Dataset&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="o">**</span><span class="n">loader_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataset" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">CSVDataset</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="torch.utils.data.Dataset">Dataset</span>[tuple[torch.<span title="torch.Tensor">Tensor</span>, torch.<span title="torch.Tensor">Tensor</span>] | torch.<span title="torch.Tensor">Tensor</span>]</code></p>

  
      <p>PyTorch Dataset for CSV files with on-demand tensor conversion.</p>
<p>This class loads CSV data into memory (using Pandas) and provides a map-style PyTorch Dataset.
It supports filtering columns, separating labels, and efficient on-demand tensor conversion
to minimize memory usage.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_pattern</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Glob pattern matching the CSV files to load.</p></td>
        </tr>
        <tr>
          <td><code>column_names</code></td>
          <td>
                <code>list[str] | None</code>
          </td>
          <td><p>Specific columns to load. If None, all columns are loaded.</p></td>
        </tr>
        <tr>
          <td><code>label_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td><p>Name of the column to use as the label. If None, no labels are returned.</p></td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>torch.<span title="torch.dtype">dtype</span></code>
          </td>
          <td><p>The data type for the features (default: <code>torch.float32</code>).</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>

<span class="c1"># Create dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">CSVDataset</span><span class="p">(</span>
    <span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;data/train_*.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target_class&quot;</span><span class="p">,</span>
    <span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;feature1&quot;</span><span class="p">,</span> <span class="s2">&quot;feature2&quot;</span><span class="p">,</span> <span class="s2">&quot;target_class&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Create DataLoader</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Iterate</span>
<span class="k">for</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">labels</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataset-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__getitem__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__getitem__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="fm">__getitem__</span><span class="p">(</span>
    <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get item at index.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>idx</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Global row index.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[torch.<span title="torch.Tensor">Tensor</span>, torch.<span title="torch.Tensor">Tensor</span>] | torch.<span title="torch.Tensor">Tensor</span></code>
          </td>
          <td><p>(features, label) tuple if labels exist, else just features.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get item at index.</span>

<span class="sd">    Args:</span>
<span class="sd">        idx: Global row index.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (features, label) tuple if labels exist, else just features.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="s2">&quot;Dataset is empty or not properly initialized.&quot;</span><span class="p">)</span>

    <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

    <span class="c1"># Convert to numpy array and then to tensor</span>
    <span class="n">features_np</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">features_np</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">label_val</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_dtype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">features</span><span class="p">,</span> <span class="n">label</span>

    <span class="k">return</span> <span class="n">features</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__len__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__len__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="fm">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return dataset length.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return dataset length.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.loaders.CSVDataset.__post_init__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__post_init__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">__post_init__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Eagerly load CSV files into a DataFrame and validate configuration.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Eagerly load CSV files into a DataFrame and validate configuration.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_files</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_dataframe</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select_columns</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_split_features_labels</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Initialized CSVDataset with &quot;</span>
            <span class="s2">&quot;n_rows=</span><span class="si">{rows}</span><span class="s2">, n_features=</span><span class="si">{features}</span><span class="s2">, labels=</span><span class="si">{labels}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">rows</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_features_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">features</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_feature_cols</span><span class="p">),</span>
            <span class="n">labels</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">DataLoadingError</span><span class="p">:</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
        <span class="k">raise</span> <span class="n">DataLoadingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to load CSV dataset: </span><span class="si">{</span><span class="n">exc</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">StreamingCSVDataset</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="torch.utils.data.IterableDataset">IterableDataset</span>[tuple[torch.<span title="torch.Tensor">Tensor</span>, torch.<span title="torch.Tensor">Tensor</span>] | torch.<span title="torch.Tensor">Tensor</span>]</code></p>

  
      <p>Streaming PyTorch IterableDataset for large CSV files.</p>
<p>This dataset is designed for datasets that are too large to fit in memory. It reads CSV files
in chunks (using Pandas) and streams samples one by one. It is compatible with PyTorch's
<code>IterableDataset</code> interface.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>file_pattern</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>Glob pattern matching the CSV files to load.</p></td>
        </tr>
        <tr>
          <td><code>column_names</code></td>
          <td>
                <code>list[str] | None</code>
          </td>
          <td><p>Specific columns to load.</p></td>
        </tr>
        <tr>
          <td><code>label_name</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td><p>Name of the label column.</p></td>
        </tr>
        <tr>
          <td><code>chunksize</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of rows to read into memory at a time per file.</p></td>
        </tr>
        <tr>
          <td><code>dtype</code></td>
          <td>
                <code>torch.<span title="torch.dtype">dtype</span></code>
          </td>
          <td><p>The data type for the features.</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">StreamingCSVDataset</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataLoader</span>

<span class="c1"># Create streaming dataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">StreamingCSVDataset</span><span class="p">(</span>
    <span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;data/large_dataset_*.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">)</span>

<span class="c1"># Create DataLoader (shuffle must be False for IterableDataset)</span>
<span class="n">dataloader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>

<span class="k">for</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
    <span class="c1"># Train model...</span>
    <span class="k">pass</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset.__iter__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__iter__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="fm">__iter__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
    <span class="n">Iterator</span><span class="p">[</span>
        <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Yield samples one by one across all CSV files.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield samples one by one across all CSV files.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Streaming CSV file: </span><span class="si">{path}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">chunk_iter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                <span class="n">file_path</span><span class="p">,</span>
                <span class="n">usecols</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">column_names</span><span class="p">,</span>
                <span class="n">chunksize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunksize</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># If usecols=None is not accepted by some pandas version</span>
            <span class="n">chunk_iter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
                <span class="n">file_path</span><span class="p">,</span>
                <span class="n">chunksize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunksize</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">chunk_df</span> <span class="ow">in</span> <span class="n">chunk_iter</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chunk_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">DataLoadingError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Label column &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="si">}</span><span class="s2">&#39; not found in &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> (columns: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">chunk_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
                    <span class="p">)</span>
                <span class="n">labels_np</span> <span class="o">=</span> <span class="n">chunk_df</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="n">features_df</span> <span class="o">=</span> <span class="n">chunk_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels_np</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">features_df</span> <span class="o">=</span> <span class="n">chunk_df</span>

            <span class="n">features_np</span> <span class="o">=</span> <span class="n">features_df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">labels_np</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">features_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span>
                        <span class="n">features_np</span><span class="p">[</span><span class="n">row_idx</span><span class="p">],</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">labels_np</span><span class="p">[</span><span class="n">row_idx</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">features_np</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span>
                        <span class="n">features_np</span><span class="p">[</span><span class="n">row_idx</span><span class="p">],</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">yield</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.data.loaders.StreamingCSVDataset.__post_init__" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">__post_init__</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">__post_init__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Resolve files eagerly and log basic configuration.</p>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/data/loaders.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resolve files eagerly and log basic configuration.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">files</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolve_files</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Initialized StreamingCSVDataset with </span><span class="si">{n_files}</span><span class="s2"> file(s), &quot;</span>
        <span class="s2">&quot;chunksize=</span><span class="si">{chunksize}</span><span class="s2">, label_name=</span><span class="si">{label}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">n_files</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="p">),</span>
        <span class="n">chunksize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chunksize</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_name</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="training">Training</h2>


<div class="doc doc-object doc-module">



<h2 id="mlpotion.frameworks.pytorch.training.trainers" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">mlpotion.frameworks.pytorch.training.trainers</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>PyTorch model training.</p>

  

  <div class="doc doc-children">






<h3 id="mlpotion.frameworks.pytorch.training.trainers-classes">Classes</h3>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.training.trainers.ModelTrainer" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">ModelTrainer</span>


</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="mlpotion.core.protocols.ModelTrainer" href="../core.html#mlpotion.core.protocols.ModelTrainer">ModelTrainerProtocol</a>[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>, <span title="torch.utils.data.DataLoader">DataLoader</span>]</code></p>

  
      <p>Generic trainer for PyTorch models.</p>
<p>This class implements the <code>ModelTrainerProtocol</code> for PyTorch models. It handles the
training loop, device placement, loss calculation, backpropagation, and validation.</p>
<p>It supports:
- Supervised learning (batch is <code>(inputs, targets)</code>).
- Unsupervised/Self-supervised learning (batch is <code>inputs</code> only, loss is <code>fn(outputs, inputs)</code>).
- Custom loss functions (string alias, <code>nn.Module</code>, or callable).
- Automatic device management (CPU/GPU).</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span></code>
          </td>
          <td><p>The PyTorch model to train.</p></td>
        </tr>
        <tr>
          <td><code>dataloader</code></td>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span></code>
          </td>
          <td><p>The training data loader.</p></td>
        </tr>
        <tr>
          <td><code>config</code></td>
          <td>
                <code><span title="mlpotion.frameworks.pytorch.config.ModelTrainingConfig">ModelTrainingConfig</span></code>
          </td>
          <td><p>Configuration for training (epochs, optimizer, etc.).</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelTrainer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelTrainingConfig</span>

<span class="c1"># Define model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Define config</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">ModelTrainingConfig</span><span class="p">(</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;mse&quot;</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span>
<span class="p">)</span>

<span class="c1"># Initialize trainer</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">ModelTrainer</span><span class="p">()</span>

<span class="c1"># Train</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">)</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.training.trainers.ModelTrainer-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.training.trainers.ModelTrainer.train" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">train</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">train</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ModelTrainingConfig</span><span class="p">,</span>
    <span class="n">validation_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainingResult</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Train a PyTorch model.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span></code>
          </td>
          <td><p>The PyTorch model (<code>nn.Module</code>) to train.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataloader</code></td>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span>[<span title="typing.Any">Any</span>]</code>
          </td>
          <td><p>The <code>DataLoader</code> providing training data.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>config</code></td>
          <td>
                <code><span title="mlpotion.frameworks.pytorch.config.ModelTrainingConfig">ModelTrainingConfig</span></code>
          </td>
          <td><p>A <code>ModelTrainingConfig</code> object containing training parameters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>validation_dataloader</code></td>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span>[<span title="typing.Any">Any</span>] | None</code>
          </td>
          <td><p>Optional <code>DataLoader</code> for validation.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.results.TrainingResult" href="../core.html#mlpotion.core.results.TrainingResult">TrainingResult</a>[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>]</code>
          </td>
          <td><p>TrainingResult[nn.Module]: A dataclass containing the trained model,</p></td>
        </tr>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.results.TrainingResult" href="../core.html#mlpotion.core.results.TrainingResult">TrainingResult</a>[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>]</code>
          </td>
          <td><p>training history (loss/metrics per epoch), and final metrics.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.exceptions.TrainingError" href="../core.html#mlpotion.core.exceptions.TrainingError">TrainingError</a></code>
          </td>
          <td><p>If the training loop encounters an error (e.g., NaN loss,</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/training/trainers.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trycatch</span><span class="p">(</span>
    <span class="n">error</span><span class="o">=</span><span class="n">ModelTrainerError</span><span class="p">,</span>
    <span class="n">success_msg</span><span class="o">=</span><span class="s2">&quot;‚úÖ Successfully trained PyTorch model&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ModelTrainingConfig</span><span class="p">,</span>
    <span class="n">validation_dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainingResult</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Train a PyTorch model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The PyTorch model (`nn.Module`) to train.</span>
<span class="sd">        dataloader: The `DataLoader` providing training data.</span>
<span class="sd">        config: A `ModelTrainingConfig` object containing training parameters.</span>
<span class="sd">        validation_dataloader: Optional `DataLoader` for validation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TrainingResult[nn.Module]: A dataclass containing the trained model,</span>
<span class="sd">        training history (loss/metrics per epoch), and final metrics.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TrainingError: If the training loop encounters an error (e.g., NaN loss,</span>
<span class="sd">        device mismatch, empty dataloader).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting PyTorch model training...&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Config: epochs=</span><span class="si">{epochs}</span><span class="s2">, lr=</span><span class="si">{lr}</span><span class="s2">, optimizer=</span><span class="si">{opt}</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;loss_fn=</span><span class="si">{loss_fn}</span><span class="s2">, device=</span><span class="si">{device}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">epochs</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">epochs</span><span class="p">,</span>
            <span class="n">lr</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">learning_rate</span><span class="p">,</span>
            <span class="n">opt</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
            <span class="n">loss_fn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Setup device</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

        <span class="c1"># Setup optimizer and loss</span>
        <span class="n">optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_optimizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_loss_fn</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># Optional limit on batches per epoch</span>
        <span class="n">max_batches_per_epoch</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;max_batches_per_epoch&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_batches_per_epoch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_batches_per_epoch</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;max_batches&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">history</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="k">if</span> <span class="n">validation_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_loss&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Initialize callbacks and TensorBoard</span>
        <span class="n">callbacks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_callbacks</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">tensorboard_writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setup_tensorboard</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="c1"># Call on_train_begin callbacks</span>
        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="s2">&quot;on_train_begin&quot;</span><span class="p">):</span>
                <span class="n">callback</span><span class="o">.</span><span class="n">on_train_begin</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
            <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
            <span class="n">epoch_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">num_batches</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

                <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
                <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

                <span class="c1"># Supervised vs unsupervised / autoencoder</span>
                <span class="k">if</span> <span class="n">targets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

                <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
                <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

                <span class="n">epoch_loss</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
                <span class="n">num_batches</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">max_batches_per_epoch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">num_batches</span> <span class="o">&gt;=</span> <span class="n">max_batches_per_epoch</span>
                <span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="s2">&quot;Reached max_batches_per_epoch=</span><span class="si">{mb}</span><span class="s2">; &quot;</span>
                        <span class="s2">&quot;stopping epoch </span><span class="si">{epoch}</span><span class="s2"> early.&quot;</span><span class="p">,</span>
                        <span class="n">mb</span><span class="o">=</span><span class="n">max_batches_per_epoch</span><span class="p">,</span>
                        <span class="n">epoch</span><span class="o">=</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="n">num_batches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">TrainingError</span><span class="p">(</span><span class="s2">&quot;Training dataloader yielded no batches.&quot;</span><span class="p">)</span>

            <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">epoch_loss</span> <span class="o">/</span> <span class="n">num_batches</span>
            <span class="n">history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_loss</span><span class="p">)</span>

            <span class="c1"># Validation phase</span>
            <span class="k">if</span> <span class="n">validation_dataloader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">val_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">(</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                    <span class="n">dataloader</span><span class="o">=</span><span class="n">validation_dataloader</span><span class="p">,</span>
                    <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span>
                    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_loss&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val_loss</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># Logging</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;verbose&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">epochs</span><span class="si">}</span><span class="s2"> - loss: </span><span class="si">{</span><span class="n">avg_loss</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">if</span> <span class="n">val_loss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - val_loss: </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="c1"># TensorBoard logging</span>
            <span class="k">if</span> <span class="n">tensorboard_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tensorboard_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="n">avg_loss</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">val_loss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">tensorboard_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span> <span class="n">val_loss</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>

            <span class="c1"># Call on_epoch_end callbacks</span>
            <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="s2">&quot;on_epoch_end&quot;</span><span class="p">):</span>
                    <span class="n">callback</span><span class="o">.</span><span class="n">on_epoch_end</span><span class="p">(</span>
                        <span class="n">epoch</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">avg_loss</span><span class="p">,</span> <span class="s2">&quot;val_loss&quot;</span><span class="p">:</span> <span class="n">val_loss</span><span class="p">}</span>
                    <span class="p">)</span>

        <span class="n">training_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="c1"># Final metrics</span>
        <span class="n">metrics</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])}</span>
        <span class="k">if</span> <span class="s2">&quot;val_loss&quot;</span> <span class="ow">in</span> <span class="n">history</span> <span class="ow">and</span> <span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_loss&quot;</span><span class="p">]:</span>
            <span class="n">metrics</span><span class="p">[</span><span class="s2">&quot;val_loss&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">history</span><span class="p">[</span><span class="s2">&quot;val_loss&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">best_epoch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_best_epoch</span><span class="p">(</span><span class="n">history</span><span class="p">)</span>

        <span class="c1"># Call on_train_end callbacks</span>
        <span class="k">for</span> <span class="n">callback</span> <span class="ow">in</span> <span class="n">callbacks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="s2">&quot;on_train_end&quot;</span><span class="p">):</span>
                <span class="n">callback</span><span class="o">.</span><span class="n">on_train_end</span><span class="p">()</span>

        <span class="c1"># Close TensorBoard writer</span>
        <span class="k">if</span> <span class="n">tensorboard_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tensorboard_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Training completed in </span><span class="si">{t:.2f}</span><span class="s2">s&quot;</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">training_time</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Final metrics: </span><span class="si">{metrics}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">TrainingResult</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
            <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">training_time</span><span class="o">=</span><span class="n">training_time</span><span class="p">,</span>
            <span class="n">best_epoch</span><span class="o">=</span><span class="n">best_epoch</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="n">TrainingError</span><span class="p">:</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
        <span class="k">raise</span> <span class="n">TrainingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training failed: </span><span class="si">{</span><span class="n">exc</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="evaluation">Evaluation</h2>


<div class="doc doc-object doc-module">



<h2 id="mlpotion.frameworks.pytorch.evaluation.evaluators" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">mlpotion.frameworks.pytorch.evaluation.evaluators</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>PyTorch model evaluation.</p>

  

  <div class="doc doc-children">






<h3 id="mlpotion.frameworks.pytorch.evaluation.evaluators-classes">Classes</h3>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">ModelEvaluator</span>


</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="mlpotion.core.protocols.ModelEvaluator" href="../core.html#mlpotion.core.protocols.ModelEvaluator">ModelEvaluatorProtocol</a>[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>, <span title="torch.utils.data.DataLoader">DataLoader</span>]</code></p>

  
      <p>Generic evaluator for PyTorch models.</p>
<p>This class implements the <code>ModelEvaluatorProtocol</code> for PyTorch models. It performs
a full pass over the evaluation dataset, computing the average loss.</p>
<p>It supports:
- Supervised and unsupervised evaluation.
- Custom loss functions.
- Automatic device management.</p>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelEvaluator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelEvaluationConfig</span>

<span class="n">evaluator</span> <span class="o">=</span> <span class="n">ModelEvaluator</span><span class="p">()</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">ModelEvaluationConfig</span><span class="p">(</span><span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;cross_entropy&quot;</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test Loss: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.evaluation.evaluators.ModelEvaluator.evaluate" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">evaluate</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">evaluate</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ModelEvaluationConfig</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationResult</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Evaluate a PyTorch model.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span></code>
          </td>
          <td><p>The PyTorch model to evaluate.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>dataloader</code></td>
          <td>
                <code><span title="torch.utils.data.DataLoader">DataLoader</span>[<span title="typing.Any">Any</span>]</code>
          </td>
          <td><p>The <code>DataLoader</code> providing evaluation data.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>config</code></td>
          <td>
                <code><span title="mlpotion.frameworks.pytorch.config.ModelEvaluationConfig">ModelEvaluationConfig</span></code>
          </td>
          <td><p>A <code>ModelEvaluationConfig</code> object containing evaluation parameters.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>EvaluationResult</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.results.EvaluationResult" href="../core.html#mlpotion.core.results.EvaluationResult">EvaluationResult</a></code>
          </td>
          <td><p>A dataclass containing the computed metrics (e.g., average loss)</p></td>
        </tr>
        <tr>
<td></td>          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.results.EvaluationResult" href="../core.html#mlpotion.core.results.EvaluationResult">EvaluationResult</a></code>
          </td>
          <td><p>and execution time.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.exceptions.EvaluationError" href="../core.html#mlpotion.core.exceptions.EvaluationError">EvaluationError</a></code>
          </td>
          <td><p>If evaluation fails.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/evaluation/evaluators.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trycatch</span><span class="p">(</span>
    <span class="n">error</span><span class="o">=</span><span class="n">ModelEvaluatorError</span><span class="p">,</span>
    <span class="n">success_msg</span><span class="o">=</span><span class="s2">&quot;‚úÖ Successfully evaluated PyTorch model&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">dataloader</span><span class="p">:</span> <span class="n">DataLoader</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ModelEvaluationConfig</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EvaluationResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluate a PyTorch model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The PyTorch model to evaluate.</span>
<span class="sd">        dataloader: The `DataLoader` providing evaluation data.</span>
<span class="sd">        config: A `ModelEvaluationConfig` object containing evaluation parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        EvaluationResult: A dataclass containing the computed metrics (e.g., average loss)</span>
<span class="sd">        and execution time.</span>

<span class="sd">    Raises:</span>
<span class="sd">        EvaluationError: If evaluation fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">device_str</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting PyTorch model evaluation...&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Config: device=</span><span class="si">{</span><span class="n">device_str</span><span class="si">}</span><span class="s2">, loss_fn=</span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;loss_fn&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mse&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device_str</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

        <span class="n">criterion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_loss_fn</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># Support optional max_batches on the config</span>
        <span class="n">max_batches</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;max_batches&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">total_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">num_batches</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
                <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

                <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">targets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">inputs</span><span class="p">)</span>

                <span class="n">total_loss</span> <span class="o">+=</span> <span class="nb">float</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
                <span class="n">num_batches</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">max_batches</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">num_batches</span> <span class="o">&gt;=</span> <span class="n">max_batches</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Reached max_batches=</span><span class="si">{</span><span class="n">max_batches</span><span class="si">}</span><span class="s2">; &quot;</span>
                        <span class="s2">&quot;stopping evaluation early.&quot;</span>
                    <span class="p">)</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="n">num_batches</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EvaluationError</span><span class="p">(</span><span class="s2">&quot;Evaluation dataloader yielded no batches.&quot;</span><span class="p">)</span>

        <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">total_loss</span> <span class="o">/</span> <span class="n">num_batches</span>
        <span class="n">evaluation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">avg_loss</span><span class="p">)}</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluation completed in </span><span class="si">{</span><span class="n">evaluation_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Metrics: </span><span class="si">{</span><span class="n">metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">EvaluationResult</span><span class="p">(</span>
            <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">evaluation_time</span><span class="o">=</span><span class="n">evaluation_time</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="n">EvaluationError</span><span class="p">:</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
        <span class="k">raise</span> <span class="n">EvaluationError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Evaluation failed: </span><span class="si">{</span><span class="n">exc</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="persistence">Persistence</h2>


<div class="doc doc-object doc-module">



<h2 id="mlpotion.frameworks.pytorch.deployment.persistence" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">mlpotion.frameworks.pytorch.deployment.persistence</span>


</h2>

  <div class="doc doc-contents first">
  
      <p>PyTorch model persistence.</p>

  

  <div class="doc doc-children">






<h3 id="mlpotion.frameworks.pytorch.deployment.persistence-classes">Classes</h3>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">ModelPersistence</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="mlpotion.core.protocols.ModelPersistence" href="../core.html#mlpotion.core.protocols.ModelPersistence">ModelPersistenceProtocol</a>[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>]</code></p>

  
      <p>Persistence helper for PyTorch models.</p>
<p>This class manages saving and loading of PyTorch models. It supports two modes:
1. <strong>State Dict (Recommended)</strong>: Saves only the model parameters (<code>model.state_dict()</code>).
   Requires the model class to be available when loading.
2. <strong>Full Model</strong>: Saves the entire model object using pickle. Less portable but easier to load.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code>str | <span title="pathlib.Path">Path</span></code>
          </td>
          <td><p>The file path for the model artifact.</p></td>
        </tr>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span> | None</code>
          </td>
          <td><p>The PyTorch model instance.</p></td>
        </tr>
    </tbody>
  </table>

<details class="example">
  <summary>Example</summary>
  <p><strong>Saving and Loading State Dict (Recommended):</strong>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelPersistence</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="c1"># Define model</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">();</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>

<span class="c1"># Save</span>
<span class="n">saver</span> <span class="o">=</span> <span class="n">ModelPersistence</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;model.pth&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
<span class="n">saver</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_full_model</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Load</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">ModelPersistence</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;model.pth&quot;</span><span class="p">)</span>
<span class="c1"># We must provide the model class or an instance for state_dict loading</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">MyModel</span><span class="p">)</span>
</code></pre></div></p>
</details>
<details class="example">
  <summary>Example</summary>
  <p><strong>Saving and Loading Full Model:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># Save</span>
<span class="n">saver</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_full_model</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Load (no model class needed)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">ModelPersistence</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;model.pth&quot;</span><span class="p">)</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</code></pre></div></p>
</details>


  

  <div class="doc doc-children">





<h5 id="mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence-attributes">Attributes</h5>

<div class="doc doc-object doc-attribute">



<h6 id="mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.path_obj" class="doc doc-heading">
        <span class="doc doc-object-name doc-attribute-name">path_obj</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>
<div class="highlight"><pre><span></span><code><span class="n">path_obj</span><span class="p">:</span> <span class="n">Path</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the model path as a <code>Path</code>.</p>
  </div>

</div>

<h5 id="mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.load" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">load</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">load</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">model_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">map_location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">model_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">torch_load_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Load a PyTorch model from disk.</p>
<p>This method automatically detects if the file is a full model checkpoint or a
state dict.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model_class</code></td>
          <td>
                <code>type[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>] | None</code>
          </td>
          <td><p>The model class to instantiate if loading a state dict and no
model instance is currently attached.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>map_location</code></td>
          <td>
                <code>str | torch.<span title="torch.device">device</span> | None</code>
          </td>
          <td><p>Device to load the model onto (default: "cpu").</p></td>
          <td>
                <code>&#39;cpu&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>strict</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether to strictly enforce state dict keys match the model.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>model_kwargs</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>] | None</code>
          </td>
          <td><p>Arguments to pass to <code>model_class</code> constructor.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>**torch_load_kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Additional arguments passed to <code>torch.load()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>, dict[str, <span title="typing.Any">Any</span>] | None]</code>
          </td>
          <td><p>nn.Module: The loaded PyTorch model.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.exceptions.ModelPersistenceError" href="../core.html#mlpotion.core.exceptions.ModelPersistenceError">ModelPersistenceError</a></code>
          </td>
          <td><p>If loading fails, or if <code>model_class</code> is missing</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/deployment/persistence.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trycatch</span><span class="p">(</span>
    <span class="n">error</span><span class="o">=</span><span class="n">ModelPersistenceError</span><span class="p">,</span>
    <span class="n">success_msg</span><span class="o">=</span><span class="s2">&quot;‚úÖ Successfully loaded PyTorch model&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">model_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">map_location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">model_kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">torch_load_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a PyTorch model from disk.</span>

<span class="sd">    This method automatically detects if the file is a full model checkpoint or a</span>
<span class="sd">    state dict.</span>

<span class="sd">    Args:</span>
<span class="sd">        model_class: The model class to instantiate if loading a state dict and no</span>
<span class="sd">            model instance is currently attached.</span>
<span class="sd">        map_location: Device to load the model onto (default: &quot;cpu&quot;).</span>
<span class="sd">        strict: Whether to strictly enforce state dict keys match the model.</span>
<span class="sd">        model_kwargs: Arguments to pass to `model_class` constructor.</span>
<span class="sd">        **torch_load_kwargs: Additional arguments passed to `torch.load()`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        nn.Module: The loaded PyTorch model.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ModelPersistenceError: If loading fails, or if `model_class` is missing</span>
<span class="sd">        when required.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_path_exists</span><span class="p">()</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading PyTorch model from </span><span class="si">{path}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

    <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="n">map_location</span><span class="p">,</span> <span class="o">**</span><span class="n">torch_load_kwargs</span><span class="p">)</span>

    <span class="c1"># Case 1: full model was saved</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Detected full-model checkpoint (nn.Module).&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">checkpoint</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PyTorch model loaded successfully from full-model checkpoint.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">checkpoint</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># Case 2: dict-like checkpoint (state_dict or wrapped)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Detected dict-like checkpoint; treating as state_dict.&quot;</span><span class="p">)</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">)</span>

        <span class="c1"># If we already have a model attached, reuse it; otherwise, we need model_class</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Using attached model instance of type </span><span class="si">{cls}</span><span class="s2"> for state_dict loading.&quot;</span><span class="p">,</span>
                <span class="bp">cls</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">model_class</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModelPersistenceError</span><span class="p">(</span>
                    <span class="s2">&quot;model_class is required when loading from a state_dict &quot;</span>
                    <span class="s2">&quot;checkpoint if no model is attached.&quot;</span>
                <span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_instantiate_model</span><span class="p">(</span><span class="n">model_class</span><span class="p">,</span> <span class="n">model_kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="n">missing</span><span class="p">,</span> <span class="n">unexpected</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;State_dict loaded with strict=True (no mismatch error raised).&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">missing</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing keys in state_dict: </span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">unexpected</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected keys in state_dict: </span><span class="si">{</span><span class="n">unexpected</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PyTorch model loaded successfully from state_dict checkpoint.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># Case 3: unsupported checkpoint structure</span>
    <span class="k">raise</span> <span class="n">ModelPersistenceError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Unsupported checkpoint type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">)</span><span class="si">!r}</span><span class="s2">. &quot;</span>
        <span class="s2">&quot;Expected nn.Module or dict-like object.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.deployment.persistence.ModelPersistence.save" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">save</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">save</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">save_full_model</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">torch_save_kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Save the attached PyTorch model to disk.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>save_full_model</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, saves the entire model object (pickle).
If False (default), saves only the <code>state_dict</code>.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>**torch_save_kwargs</code></td>
          <td>
                <code><span title="typing.Any">Any</span></code>
          </td>
          <td><p>Additional arguments passed to <code>torch.save()</code>.</p></td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.exceptions.ModelPersistenceError" href="../core.html#mlpotion.core.exceptions.ModelPersistenceError">ModelPersistenceError</a></code>
          </td>
          <td><p>If no model is attached or saving fails.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/deployment/persistence.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trycatch</span><span class="p">(</span>
    <span class="n">error</span><span class="o">=</span><span class="n">ModelPersistenceError</span><span class="p">,</span>
    <span class="n">success_msg</span><span class="o">=</span><span class="s2">&quot;‚úÖ Successfully saved PyTorch model&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">save_full_model</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">torch_save_kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the attached PyTorch model to disk.</span>

<span class="sd">    Args:</span>
<span class="sd">        save_full_model: If True, saves the entire model object (pickle).</span>
<span class="sd">            If False (default), saves only the `state_dict`.</span>
<span class="sd">        **torch_save_kwargs: Additional arguments passed to `torch.save()`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ModelPersistenceError: If no model is attached or saving fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_model</span><span class="p">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path_obj</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
        <span class="s2">&quot;Saving PyTorch model to </span><span class="si">{path}</span><span class="s2"> (</span><span class="si">{mode}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="n">path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;full model&quot;</span> <span class="k">if</span> <span class="n">save_full_model</span> <span class="k">else</span> <span class="s2">&quot;state_dict&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_full_model</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;Saving a full model object. This is less portable and may break &quot;</span>
            <span class="s2">&quot;if the code structure changes. Prefer saving a state_dict for &quot;</span>
            <span class="s2">&quot;long-term storage.&quot;</span>
        <span class="p">)</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">torch_save_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">torch_save_kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;PyTorch model saved successfully.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><h2 id="export">Export</h2>


<div class="doc doc-object doc-module">



<h2 id="mlpotion.frameworks.pytorch.deployment.exporters" class="doc doc-heading">
          <span class="doc doc-object-name doc-module-name">mlpotion.frameworks.pytorch.deployment.exporters</span>


</h2>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">






<h3 id="mlpotion.frameworks.pytorch.deployment.exporters-classes">Classes</h3>

<div class="doc doc-object doc-class">



<h4 id="mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">ModelExporter</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="mlpotion.core.protocols.ModelExporter" href="../core.html#mlpotion.core.protocols.ModelExporter">ModelExporterProtocol</a>[<span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span>]</code></p>

  
      <p>Export PyTorch models to TorchScript, ONNX, or state_dict formats.</p>
<p>This class implements the <code>ModelExporterProtocol</code> for PyTorch. It supports exporting
models for deployment or interoperability.</p>
<p>Supported formats:
- <strong>torchscript</strong>: Exports via <code>torch.jit.script</code> or <code>torch.jit.trace</code>.
- <strong>onnx</strong>: Exports to ONNX format (requires <code>example_input</code>).
- <strong>state_dict</strong>: Saves the model parameters.</p>

<details class="example">
  <summary>Example</summary>
  <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelExporter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.pytorch.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelExportConfig</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="c1"># Prepare model and input</span>
<span class="n">model</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">example_input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">)</span>

<span class="c1"># Export to ONNX</span>
<span class="n">exporter</span> <span class="o">=</span> <span class="n">ModelExporter</span><span class="p">()</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">ModelExportConfig</span><span class="p">(</span>
    <span class="n">export_path</span><span class="o">=</span><span class="s2">&quot;models/model.onnx&quot;</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;onnx&quot;</span><span class="p">,</span>
    <span class="n">example_input</span><span class="o">=</span><span class="n">example_input</span>
<span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">exporter</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
</code></pre></div>
</details>


  

  <div class="doc doc-children">







<h5 id="mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter-functions">Functions</h5>

<div class="doc doc-object doc-function">



<h6 id="mlpotion.frameworks.pytorch.deployment.exporters.ModelExporter.export" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">export</span>


</h6>
<div class="highlight"><pre><span></span><code><span class="n">export</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">ModelExportConfig</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExportResult</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Export a PyTorch model to the specified format.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code><span title="torch.nn">nn</span>.<span title="torch.nn.Module">Module</span></code>
          </td>
          <td><p>The PyTorch model to export.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>config</code></td>
          <td>
                <code><span title="mlpotion.frameworks.pytorch.config.ModelExportConfig">ModelExportConfig</span></code>
          </td>
          <td><p>Configuration object specifying format, path, and other options.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>ExportResult</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.results.ExportResult" href="../core.html#mlpotion.core.results.ExportResult">ExportResult</a></code>
          </td>
          <td><p>A dataclass containing the path to the exported artifact and metadata.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="mlpotion.core.exceptions.ExportError" href="../core.html#mlpotion.core.exceptions.ExportError">ExportError</a></code>
          </td>
          <td><p>If the export process fails (e.g., invalid format, missing example input).</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>mlpotion/frameworks/pytorch/deployment/exporters.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@trycatch</span><span class="p">(</span>
    <span class="n">error</span><span class="o">=</span><span class="n">ModelExporterError</span><span class="p">,</span>
    <span class="n">success_msg</span><span class="o">=</span><span class="s2">&quot;‚úÖ Successfully Exported model&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">export</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">ModelExportConfig</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExportResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Export a PyTorch model to the specified format.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The PyTorch model to export.</span>
<span class="sd">        config: Configuration object specifying format, path, and other options.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ExportResult: A dataclass containing the path to the exported artifact and metadata.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ExportError: If the export process fails (e.g., invalid format, missing example input).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">export_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">export_path</span><span class="p">)</span>
        <span class="n">export_root</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">fmt</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">device_str</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span><span class="p">,</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device_str</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Exporting PyTorch model &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;[format=</span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="s2">, device=</span><span class="si">{</span><span class="n">device_str</span><span class="si">}</span><span class="s2">, target=</span><span class="si">{</span><span class="n">export_root</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>

        <span class="c1"># Dispatch</span>
        <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s2">&quot;torchscript&quot;</span><span class="p">:</span>
            <span class="n">final_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_export_torchscript</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                <span class="n">export_root</span><span class="o">=</span><span class="n">export_root</span><span class="p">,</span>
                <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s2">&quot;onnx&quot;</span><span class="p">:</span>
            <span class="n">final_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_export_onnx</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                <span class="n">export_root</span><span class="o">=</span><span class="n">export_root</span><span class="p">,</span>
                <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s2">&quot;state_dict&quot;</span><span class="p">:</span>
            <span class="n">final_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_export_state_dict</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                <span class="n">export_root</span><span class="o">=</span><span class="n">export_root</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ExportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown export format: </span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">format</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model successfully exported ‚Üí </span><span class="si">{</span><span class="n">final_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;model_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pytorch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="n">fmt</span><span class="p">,</span>
            <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="n">device_str</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">ExportResult</span><span class="p">(</span>
            <span class="n">export_path</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">final_path</span><span class="p">),</span>
            <span class="nb">format</span><span class="o">=</span><span class="n">fmt</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">except</span> <span class="n">ExportError</span><span class="p">:</span>
        <span class="k">raise</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># noqa: BLE001</span>
        <span class="k">raise</span> <span class="n">ExportError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Export failed: </span><span class="si">{</span><span class="n">exc</span><span class="si">!s}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div><hr />
<p align="center">
  <em>See the <a href="../../frameworks/pytorch/">PyTorch Guide</a> for usage examples</em>
</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/UnicoLab/MLPotion" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mlpotion/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../assets/js/fix-image-paths.js"></script>
      
    
  </body>
</html>