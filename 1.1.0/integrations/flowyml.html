
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://github.com/UnicoLab/MLPotion/1.1.0/integrations/flowyml.html">
      
      
        <link rel="prev" href="../frameworks/keras.html">
      
      
        <link rel="next" href="zenml.html">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Overview - MLPotion - Machine Learning Potion</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.5%201.75v11.5c0%20.138.112.25.25.25h3.17a.75.75%200%200%201%200%201.5H2.75A1.75%201.75%200%200%201%201%2013.25V1.75C1%20.784%201.784%200%202.75%200h8.5C12.216%200%2013%20.784%2013%201.75v7.736a.75.75%200%200%201-1.5%200V1.75a.25.25%200%200%200-.25-.25h-8.5a.25.25%200%200%200-.25.25m13.274%209.537zl-4.557%204.45a.75.75%200%200%201-1.055-.008l-1.943-1.95a.75.75%200%200%201%201.062-1.058l1.419%201.425%204.026-3.932a.75.75%200%201%201%201.048%201.074M4.75%204h4.5a.75.75%200%200%201%200%201.5h-4.5a.75.75%200%200%201%200-1.5M4%207.75A.75.75%200%200%201%204.75%207h2a.75.75%200%200%201%200%201.5h-2A.75.75%200%200%201%204%207.75%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#flowyml-integration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="MLPotion - Machine Learning Potion" class="md-header__button md-logo" aria-label="MLPotion - Machine Learning Potion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MLPotion - Machine Learning Potion
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/UnicoLab/MLPotion" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ML-Potion
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="MLPotion - Machine Learning Potion" class="md-nav__button md-logo" aria-label="MLPotion - Machine Learning Potion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 11a1 1 0 0 1 1 1 1 1 0 0 1-1 1 1 1 0 0 1-1-1 1 1 0 0 1 1-1M4.22 4.22C5.65 2.79 8.75 3.43 12 5.56c3.25-2.13 6.35-2.77 7.78-1.34s.79 4.53-1.34 7.78c2.13 3.25 2.77 6.35 1.34 7.78s-4.53.79-7.78-1.34c-3.25 2.13-6.35 2.77-7.78 1.34S3.43 15.25 5.56 12C3.43 8.75 2.79 5.65 4.22 4.22m11.32 4.24c.61.62 1.17 1.25 1.69 1.88 1.38-2.13 1.88-3.96 1.13-4.7-.74-.75-2.57-.25-4.7 1.13.63.52 1.26 1.08 1.88 1.69m-7.08 7.08c-.61-.62-1.17-1.25-1.69-1.88-1.38 2.13-1.88 3.96-1.13 4.7.74.75 2.57.25 4.7-1.13-.63-.52-1.26-1.08-1.88-1.69m-2.82-9.9c-.75.74-.25 2.57 1.13 4.7.52-.63 1.08-1.26 1.69-1.88.62-.61 1.25-1.17 1.88-1.69-2.13-1.38-3.96-1.88-4.7-1.13m4.24 8.48c.7.7 1.42 1.34 2.12 1.91.7-.57 1.42-1.21 2.12-1.91s1.34-1.42 1.91-2.12c-.57-.7-1.21-1.42-1.91-2.12S12.7 8.54 12 7.97c-.7.57-1.42 1.21-2.12 1.91S8.54 11.3 7.97 12c.57.7 1.21 1.42 1.91 2.12m8.48 4.24c.75-.74.25-2.57-1.13-4.7-.52.63-1.08 1.26-1.69 1.88-.62.61-1.25 1.17-1.88 1.69 2.13 1.38 3.96 1.88 4.7 1.13"/></svg>

    </a>
    MLPotion - Machine Learning Potion
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UnicoLab/MLPotion" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ML-Potion
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    üè† Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üöÄ Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    üöÄ Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/concepts.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üîß Frameworks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    üîß Frameworks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/tensorflow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TensorFlow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/pytorch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameworks/keras.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keras
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üîÑ Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    üîÑ Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    FlowyML
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    FlowyML
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="flowyml.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#train-a-keras-model-in-5-lines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Train a Keras Model in 5 Lines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flowyml-features-used" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyML Features Used
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reusable-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reusable Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reusable Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step Design Principles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keras-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keras Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keras Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        train_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspect_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        inspect_model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        PyTorch Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyTorch Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load_csv_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_csv_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load_streaming_csv_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_streaming_csv_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        train_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_model-load_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_model / load_model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        TensorFlow Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFlow Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimize_data-tf-exclusive" class="md-nav__link">
    <span class="md-ellipsis">
      
        optimize_data (TF-exclusive)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-flowymladapter-generic-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        The FlowyMLAdapter (Generic Steps)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The FlowyMLAdapter (Generic Steps)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flowymladaptercreate_data_loader_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyMLAdapter.create_data_loader_step()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowymladaptercreate_training_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyMLAdapter.create_training_step()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowymladaptercreate_evaluation_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyMLAdapter.create_evaluation_step()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-custom-component-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Custom Component ‚Üí Pipeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-templates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Templates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Design Principles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-availability-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Availability Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-training-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Training Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-full-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Full Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-evaluation-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Evaluation Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-export-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Export Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-experiment-pipeline-conditional-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Experiment Pipeline (Conditional Deploy)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-scheduled-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Scheduled Pipeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#composing-custom-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Composing Custom Pipelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Composing Custom Pipelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-custom-train-inspect-export-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Custom Train ‚Üí Inspect ‚Üí Export Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-adding-a-custom-step" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Adding a Custom Step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-mixing-adapter-and-pre-built-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Mixing Adapter and Pre-built Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifact-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        Artifact Types
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artifact Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag-wiring" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAG Wiring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG Wiring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifact-unwrapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Artifact Unwrapping
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-decorator-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step Decorator Options
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Caching Strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu-resources-execution-groups" class="md-nav__link">
    <span class="md-ellipsis">
      
        GPU Resources &amp; Execution Groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Injection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Context Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-context-parameter-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Context Parameter Reference
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Patterns
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cross-framework-reuse" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Framework Reuse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combining-steps-from-different-frameworks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Combining Steps from Different Frameworks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-custom-step-from-mlpotion-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building a Custom Step from MLPotion Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-flows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conditional Flows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lineage-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lineage Tracking
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#framework-specific-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Framework-Specific Notes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Framework-Specific Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keras" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keras
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      
        PyTorch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        TensorFlow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-by-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Steps by Framework
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps by Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keras-mlpotionintegrationsflowymlkeras" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keras (mlpotion.integrations.flowyml.keras)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch-mlpotionintegrationsflowymlpytorch" class="md-nav__link">
    <span class="md-ellipsis">
      
        PyTorch (mlpotion.integrations.flowyml.pytorch)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow-mlpotionintegrationsflowymltensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        TensorFlow (mlpotion.integrations.flowyml.tensorflow)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-adapter-mlpotionintegrationsflowymlflowymladapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generic Adapter (mlpotion.integrations.flowyml.FlowyMLAdapter)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipelines-by-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipelines by Framework
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="zenml.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZenML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üéì Tutorials
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    üéì Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/basic-pipeline.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Basic Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/flowyml-quickstart.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FlowyML Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/flowyml-custom-pipeline.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FlowyML Custom Pipelines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/flowyml-experiment-tracking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FlowyML Experiment Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/flowyml-scheduled-retraining.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FlowyML Scheduled Retraining
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/zenml-integration.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZenML Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/multi-framework.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    üìñ API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    üìñ API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Core
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/frameworks/tensorflow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    TensorFlow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/frameworks/pytorch.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PyTorch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/frameworks/keras.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Keras
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/integrations/flowyml.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FlowyML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/integrations/zenml.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ZenML
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ü§ù Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    ü§ù Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Start
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quick Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#train-a-keras-model-in-5-lines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Train a Keras Model in 5 Lines
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flowyml-features-used" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyML Features Used
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reusable-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reusable Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reusable Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step Design Principles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keras-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keras Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Keras Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transform_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        transform_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        train_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspect_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        inspect_model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        PyTorch Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyTorch Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load_csv_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_csv_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load_streaming_csv_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_streaming_csv_data
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#train_model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        train_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate_model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        evaluate_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export_model_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        export_model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#save_model-load_model" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_model / load_model
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        TensorFlow Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TensorFlow Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimize_data-tf-exclusive" class="md-nav__link">
    <span class="md-ellipsis">
      
        optimize_data (TF-exclusive)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-flowymladapter-generic-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        The FlowyMLAdapter (Generic Steps)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The FlowyMLAdapter (Generic Steps)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flowymladaptercreate_data_loader_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyMLAdapter.create_data_loader_step()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowymladaptercreate_training_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyMLAdapter.create_training_step()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flowymladaptercreate_evaluation_step" class="md-nav__link">
    <span class="md-ellipsis">
      
        FlowyMLAdapter.create_evaluation_step()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-custom-component-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Custom Component ‚Üí Pipeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline-templates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Templates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pipeline Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pipeline-design-principles" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Design Principles
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-availability-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipeline Availability Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-training-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Training Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-full-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Full Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-evaluation-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. Evaluation Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-export-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Export Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-experiment-pipeline-conditional-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Experiment Pipeline (Conditional Deploy)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-scheduled-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Scheduled Pipeline
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#composing-custom-pipelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Composing Custom Pipelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Composing Custom Pipelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-custom-train-inspect-export-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Custom Train ‚Üí Inspect ‚Üí Export Pipeline
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-adding-a-custom-step" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Adding a Custom Step
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-mixing-adapter-and-pre-built-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Mixing Adapter and Pre-built Steps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#artifact-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        Artifact Types
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Artifact Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dataset
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dag-wiring" class="md-nav__link">
    <span class="md-ellipsis">
      
        DAG Wiring
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DAG Wiring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#artifact-unwrapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Artifact Unwrapping
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-decorator-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step Decorator Options
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Caching Strategies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu-resources-execution-groups" class="md-nav__link">
    <span class="md-ellipsis">
      
        GPU Resources &amp; Execution Groups
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context-injection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Injection
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Context Injection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#complete-context-parameter-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Complete Context Parameter Reference
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advanced Patterns
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Patterns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cross-framework-reuse" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cross-Framework Reuse
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combining-steps-from-different-frameworks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Combining Steps from Different Frameworks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-custom-step-from-mlpotion-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building a Custom Step from MLPotion Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conditional-flows" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conditional Flows
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lineage-tracking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lineage Tracking
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#framework-specific-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Framework-Specific Notes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Framework-Specific Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keras" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keras
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch" class="md-nav__link">
    <span class="md-ellipsis">
      
        PyTorch
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        TensorFlow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        API Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#steps-by-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Steps by Framework
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps by Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#keras-mlpotionintegrationsflowymlkeras" class="md-nav__link">
    <span class="md-ellipsis">
      
        Keras (mlpotion.integrations.flowyml.keras)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pytorch-mlpotionintegrationsflowymlpytorch" class="md-nav__link">
    <span class="md-ellipsis">
      
        PyTorch (mlpotion.integrations.flowyml.pytorch)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tensorflow-mlpotionintegrationsflowymltensorflow" class="md-nav__link">
    <span class="md-ellipsis">
      
        TensorFlow (mlpotion.integrations.flowyml.tensorflow)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generic-adapter-mlpotionintegrationsflowymlflowymladapter" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generic Adapter (mlpotion.integrations.flowyml.FlowyMLAdapter)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipelines-by-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Pipelines by Framework
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="flowyml-integration">FlowyML Integration</h1>
<p>MLPotion provides a <strong>first-class integration</strong> with <a href="https://github.com/UnicoLab/FlowyML">FlowyML</a>,
an artifact-centric ML pipeline framework. Every MLPotion component (data loaders,
trainers, evaluators, exporters) is exposed as a fully-wired FlowyML <code>@step</code> that
returns <strong>typed artifacts</strong> ‚Äî <code>Dataset</code>, <code>Model</code>, and <code>Metrics</code> ‚Äî with automatic
metadata extraction, lineage tracking, and DAG resolution.</p>
<blockquote>
<p><strong>TL;DR</strong> ‚Äî Install with <code>pip install mlpotion[flowyml,keras]</code>, pick a pipeline
template, pass a <code>Context</code>, and call <code>.run()</code>. The integration handles artifact
wrapping, metadata, caching, retry, and DAG wiring for you.</p>
</blockquote>
<hr />
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#quick-start">Quick Start</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#reusable-steps">Reusable Steps</a></li>
<li><a href="#step-design-principles">Step Design Principles</a></li>
<li><a href="#keras-steps">Keras Steps</a></li>
<li><a href="#pytorch-steps">PyTorch Steps</a></li>
<li><a href="#tensorflow-steps">TensorFlow Steps</a></li>
<li><a href="#the-flowymladapter-generic-steps">The <code>FlowyMLAdapter</code> (Generic Steps)</a></li>
<li><a href="#pipeline-templates">Pipeline Templates</a></li>
<li><a href="#pipeline-design-principles">Pipeline Design Principles</a></li>
<li><a href="#1-training-pipeline">1. Training Pipeline</a></li>
<li><a href="#2-full-pipeline">2. Full Pipeline</a></li>
<li><a href="#3-evaluation-pipeline">3. Evaluation Pipeline</a></li>
<li><a href="#4-export-pipeline">4. Export Pipeline</a></li>
<li><a href="#5-experiment-pipeline-conditional-deploy">5. Experiment Pipeline (Conditional Deploy)</a></li>
<li><a href="#6-scheduled-pipeline">6. Scheduled Pipeline</a></li>
<li><a href="#composing-custom-pipelines">Composing Custom Pipelines</a></li>
<li><a href="#artifact-types">Artifact Types</a></li>
<li><a href="#dag-wiring">DAG Wiring</a></li>
<li><a href="#step-decorator-options">Step Decorator Options</a></li>
<li><a href="#caching-strategies">Caching Strategies</a></li>
<li><a href="#gpu-resources--execution-groups">GPU Resources &amp; Execution Groups</a></li>
<li><a href="#context-injection">Context Injection</a></li>
<li><a href="#advanced-patterns">Advanced Patterns</a></li>
<li><a href="#cross-framework-reuse">Cross-Framework Reuse</a></li>
<li><a href="#combining-steps-from-different-frameworks">Combining Steps from Different Frameworks</a></li>
<li><a href="#building-a-custom-step-from-mlpotion-components">Building a Custom Step from MLPotion Components</a></li>
<li><a href="#conditional-flows">Conditional Flows</a></li>
<li><a href="#lineage-tracking">Lineage Tracking</a></li>
<li><a href="#framework-specific-notes">Framework-Specific Notes</a></li>
<li><a href="#api-reference">API Reference</a></li>
</ul>
<hr />
<h2 id="quick-start">Quick Start</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Install MLPotion with FlowyML support</span>
pip<span class="w"> </span>install<span class="w"> </span>mlpotion<span class="o">[</span>flowyml,keras<span class="o">]</span>
</code></pre></div>
<h3 id="train-a-keras-model-in-5-lines">Train a Keras Model in 5 Lines</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">create_keras_training_pipeline</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;quick-start&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_keras_training_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="installation">Installation</h2>
<p>Install the integration alongside the framework you need:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Keras</span>
pip<span class="w"> </span>install<span class="w"> </span>mlpotion<span class="o">[</span>flowyml,keras<span class="o">]</span>

<span class="c1"># PyTorch</span>
pip<span class="w"> </span>install<span class="w"> </span>mlpotion<span class="o">[</span>flowyml,pytorch<span class="o">]</span>

<span class="c1"># TensorFlow</span>
pip<span class="w"> </span>install<span class="w"> </span>mlpotion<span class="o">[</span>flowyml,tensorflow<span class="o">]</span>

<span class="c1"># All frameworks</span>
pip<span class="w"> </span>install<span class="w"> </span>mlpotion<span class="o">[</span>flowyml,keras,pytorch,tensorflow<span class="o">]</span>
</code></pre></div>
<p>The <code>FLOWYML_AVAILABLE</code> flag is set at import time ‚Äî if <code>flowyml</code> is not
installed, the integration module skips all imports gracefully:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">FLOWYML_AVAILABLE</span>

<span class="k">if</span> <span class="n">FLOWYML_AVAILABLE</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_training_pipeline</span>
</code></pre></div>
<hr />
<h2 id="architecture">Architecture</h2>
<div class="highlight"><pre><span></span><code>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FlowyML Runtime                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ DAG      ‚îÇ  ‚îÇ Caching  ‚îÇ  ‚îÇ Retry    ‚îÇ  ‚îÇ Resource ‚îÇ ‚îÇ
‚îÇ  ‚îÇ Resolver ‚îÇ  ‚îÇ Engine   ‚îÇ  ‚îÇ Logic    ‚îÇ  ‚îÇ Scheduler‚îÇ ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                        ‚îÇ                                  ‚îÇ
‚îÇ            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                      ‚îÇ
‚îÇ            ‚ñº           ‚ñº           ‚ñº                      ‚îÇ
‚îÇ      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îÇ
‚îÇ      ‚îÇ  Keras   ‚îÇ ‚îÇ PyTorch  ‚îÇ ‚îÇ TF/Keras ‚îÇ  ‚Üê Steps    ‚îÇ
‚îÇ      ‚îÇ  Steps   ‚îÇ ‚îÇ  Steps   ‚îÇ ‚îÇ  Steps   ‚îÇ             ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îÇ
‚îÇ            ‚îÇ           ‚îÇ           ‚îÇ                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚ñº           ‚ñº           ‚ñº
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ        MLPotion Components           ‚îÇ
      ‚îÇ  CSVDataLoader ¬∑ ModelTrainer ¬∑      ‚îÇ
      ‚îÇ  ModelEvaluator ¬∑ ModelExporter ¬∑    ‚îÇ
      ‚îÇ  ModelPersistence ¬∑ ModelInspector   ‚îÇ
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div>
<h3 id="flowyml-features-used">FlowyML Features Used</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>How We Use It</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Artifact types</strong></td>
<td>Every step returns <code>Dataset</code>, <code>Model</code>, or <code>Metrics</code> with auto-metadata</td>
</tr>
<tr>
<td><strong>DAG wiring</strong></td>
<td><code>inputs</code>/<code>outputs</code> on <code>@step</code> enable auto-resolution between steps</td>
</tr>
<tr>
<td><strong>Caching</strong></td>
<td><code>cache="code_hash"</code> or <code>cache="input_hash"</code> skips unchanged steps</td>
</tr>
<tr>
<td><strong>Retry</strong></td>
<td><code>retry=1</code> on training steps for transient failures</td>
</tr>
<tr>
<td><strong>Resource specs</strong></td>
<td><code>ResourceRequirements(cpu, memory, gpu)</code> on GPU-intensive steps</td>
</tr>
<tr>
<td><strong>Execution groups</strong></td>
<td><code>execution_group="training"</code> groups training + eval on same node</td>
</tr>
<tr>
<td><strong>Tags</strong></td>
<td><code>tags={"framework": "keras"}</code> for filtering and observability</td>
</tr>
<tr>
<td><strong>Context injection</strong></td>
<td><code>Context(...)</code> provides hyperparameters to all steps</td>
</tr>
<tr>
<td><strong>Conditional flows</strong></td>
<td><code>If(condition=..., then_steps=[...])</code> for conditional deployment</td>
</tr>
<tr>
<td><strong>Scheduling</strong></td>
<td><code>PipelineScheduler</code> with cron syntax for periodic retraining</td>
</tr>
<tr>
<td><strong>Checkpointing</strong></td>
<td><code>enable_checkpointing=True</code> for resumable long-running pipelines</td>
</tr>
<tr>
<td><strong>Experiment tracking</strong></td>
<td><code>FlowymlKerasCallback</code> auto-captures all training metrics live</td>
</tr>
<tr>
<td><strong>Lineage</strong></td>
<td><code>parent=</code> links transformed datasets back to their source</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="reusable-steps">Reusable Steps</h2>
<p>Every step in the integration follows the same design contract:</p>
<ol>
<li><strong>Accepts raw objects <em>or</em> FlowyML artifacts</strong> ‚Äî steps auto-unwrap <code>Dataset.data</code>, <code>Model.data</code>, etc.</li>
<li><strong>Returns a typed artifact</strong> ‚Äî <code>Dataset</code>, <code>Model</code>, or <code>Metrics</code> with auto-extracted metadata.</li>
<li><strong>Declares <code>inputs</code>/<code>outputs</code></strong> ‚Äî enables FlowyML DAG auto-wiring.</li>
<li><strong>Ships without hardcoded resource requirements</strong> ‚Äî portable across CPU and GPU environments.</li>
<li><strong>Is independently usable</strong> ‚Äî every step can be called standalone or composed into pipelines.</li>
</ol>
<h3 id="step-design-principles">Step Design Principles</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Every step can be used in three ways:</span>

<span class="c1"># 1. Standalone ‚Äî call it directly as a function</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

<span class="c1"># 2. In a pipeline ‚Äî add it to a Pipeline object</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="s2">&quot;my_pipeline&quot;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">load_data</span><span class="p">)</span>

<span class="c1"># 3. Via the adapter ‚Äî wrap any MLPotion protocol component</span>
<span class="n">step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_data_loader_step</span><span class="p">(</span><span class="n">my_custom_loader</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
</code></pre></div>
<hr />
<h3 id="keras-steps">Keras Steps</h3>
<p><strong>Module:</strong> <code>mlpotion.integrations.flowyml.keras</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">load_data</span><span class="p">,</span>         <span class="c1"># CSV ‚Üí Dataset artifact</span>
    <span class="n">transform_data</span><span class="p">,</span>    <span class="c1"># Dataset + Model ‚Üí transformed Dataset artifact</span>
    <span class="n">train_model</span><span class="p">,</span>       <span class="c1"># Model + Dataset ‚Üí (Model, Metrics) artifacts</span>
    <span class="n">evaluate_model</span><span class="p">,</span>    <span class="c1"># Model + Dataset ‚Üí Metrics artifact</span>
    <span class="n">export_model</span><span class="p">,</span>      <span class="c1"># Model ‚Üí exported Model artifact</span>
    <span class="n">save_model</span><span class="p">,</span>        <span class="c1"># Model ‚Üí saved Model artifact</span>
    <span class="n">load_model</span><span class="p">,</span>        <span class="c1"># path ‚Üí Model artifact</span>
    <span class="n">inspect_model</span><span class="p">,</span>     <span class="c1"># Model ‚Üí Metrics artifact (architecture details)</span>
<span class="p">)</span>
</code></pre></div>
<h4 id="load_data"><code>load_data</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Glob pattern for CSV files</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>int</code></td>
<td><code>32</code></td>
<td>Batch size for the CSVSequence</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>Target column name</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td><code>list[str] \| None</code></td>
<td><code>None</code></td>
<td>Columns to load (None = all)</td>
</tr>
<tr>
<td><code>shuffle</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether to shuffle data</td>
</tr>
<tr>
<td><code>dtype</code></td>
<td><code>str</code></td>
<td><code>"float32"</code></td>
<td>Data type for numeric conversion</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Dataset</code> artifact with <code>source</code>, <code>batch_size</code>, <code>batches</code>, <code>label_name</code> metadata.</p>
<p><strong>Decorator config:</strong> <code>outputs=["dataset"]</code>, <code>cache="code_hash"</code>, <code>tags={"framework": "keras"}</code></p>
<div class="highlight"><pre><span></span><code><span class="n">dataset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">)</span>

<span class="c1"># Access raw data</span>
<span class="n">raw_sequence</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span>          <span class="c1"># CSVSequence</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>   <span class="c1"># {&#39;source&#39;: &#39;...&#39;, &#39;batch_size&#39;: 32, ...}</span>
</code></pre></div>
<h4 id="transform_data"><code>transform_data</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dataset</code></td>
<td><code>Dataset</code></td>
<td>‚Äî</td>
<td>Input Dataset artifact</td>
</tr>
<tr>
<td><code>model</code></td>
<td><code>keras.Model</code></td>
<td>‚Äî</td>
<td>Model for generating predictions</td>
</tr>
<tr>
<td><code>data_output_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Output path for transformed CSV</td>
</tr>
<tr>
<td><code>data_output_per_batch</code></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>One file per batch</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>int \| None</code></td>
<td><code>None</code></td>
<td>Batch size override</td>
</tr>
<tr>
<td><code>feature_names</code></td>
<td><code>list[str] \| None</code></td>
<td><code>None</code></td>
<td>Feature names for output</td>
</tr>
<tr>
<td><code>input_columns</code></td>
<td><code>list[str] \| None</code></td>
<td><code>None</code></td>
<td>Input columns to pass to model</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Dataset</code> artifact with <strong>parent lineage</strong> linked to the input dataset.</p>
<p><strong>Decorator config:</strong> <code>inputs=["dataset"]</code>, <code>outputs=["transformed"]</code>, <code>cache="code_hash"</code></p>
<h4 id="train_model"><code>train_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>keras.Model</code></td>
<td>‚Äî</td>
<td>Compiled Keras model</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>CSVSequence \| Dataset</code></td>
<td>‚Äî</td>
<td>Training data</td>
</tr>
<tr>
<td><code>epochs</code></td>
<td><code>int</code></td>
<td><code>10</code></td>
<td>Number of epochs</td>
</tr>
<tr>
<td><code>learning_rate</code></td>
<td><code>float</code></td>
<td><code>0.001</code></td>
<td>Learning rate</td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td><code>1</code></td>
<td>Keras verbosity level</td>
</tr>
<tr>
<td><code>validation_data</code></td>
<td><code>CSVSequence \| Dataset \| None</code></td>
<td><code>None</code></td>
<td>Validation data</td>
</tr>
<tr>
<td><code>callbacks</code></td>
<td><code>list[Callback] \| None</code></td>
<td><code>None</code></td>
<td>Extra Keras callbacks</td>
</tr>
<tr>
<td><code>experiment_name</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>FlowyML experiment name</td>
</tr>
<tr>
<td><code>project</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>FlowyML project name</td>
</tr>
<tr>
<td><code>log_model</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Log model artifact after training</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>tuple[Model, Metrics]</code> ‚Äî Model via <code>Model.from_keras()</code> with auto-extracted architecture metadata; Metrics with training history.</p>
<p><strong>Decorator config:</strong> <code>inputs=["dataset"]</code>, <code>outputs=["model", "training_metrics"]</code>, <code>cache=False</code>, <code>retry=1</code></p>
<blockquote>
<p><strong>üîë Key feature:</strong> A <code>FlowymlKerasCallback</code> is <strong>automatically attached</strong> to
capture all training metrics live to the FlowyML dashboard.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="n">model_asset</span><span class="p">,</span> <span class="n">metrics_asset</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="n">my_keras_model</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">metrics_asset</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics_asset</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>           <span class="c1"># All metrics as dict</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_asset</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>  <span class="c1"># Auto-extracted: layers, params, etc.</span>
</code></pre></div>
<h4 id="evaluate_model"><code>evaluate_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>keras.Model \| Model</code></td>
<td>‚Äî</td>
<td>Trained model or Model artifact</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>CSVSequence \| Dataset</code></td>
<td>‚Äî</td>
<td>Evaluation data</td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>int</code></td>
<td><code>0</code></td>
<td>Keras verbosity level</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Metrics</code> artifact with evaluation results.</p>
<p><strong>Decorator config:</strong> <code>inputs=["model", "dataset"]</code>, <code>outputs=["metrics"]</code>, <code>cache="input_hash"</code></p>
<h4 id="export_model"><code>export_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>keras.Model \| Model</code></td>
<td>‚Äî</td>
<td>Model to export</td>
</tr>
<tr>
<td><code>export_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Destination path</td>
</tr>
<tr>
<td><code>export_format</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>Format: <code>"keras"</code>, <code>"saved_model"</code>, <code>"tflite"</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Model</code> artifact with export metadata.</p>
<p><strong>Decorator config:</strong> <code>inputs=["model"]</code>, <code>outputs=["exported_model"]</code>, <code>cache="code_hash"</code></p>
<h4 id="save_model"><code>save_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>keras.Model \| Model</code></td>
<td>‚Äî</td>
<td>Model to save</td>
</tr>
<tr>
<td><code>save_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Destination file path</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Model</code> artifact with save location metadata.</p>
<p><strong>Decorator config:</strong> <code>inputs=["model"]</code>, <code>outputs=["saved_model"]</code></p>
<h4 id="load_model"><code>load_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Path to saved model</td>
</tr>
<tr>
<td><code>inspect</code></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Log inspection info</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Model</code> artifact wrapping the loaded Keras model.</p>
<p><strong>Decorator config:</strong> <code>outputs=["model"]</code>, <code>cache="code_hash"</code></p>
<h4 id="inspect_model"><code>inspect_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>keras.Model \| Model</code></td>
<td>‚Äî</td>
<td>Model to inspect</td>
</tr>
<tr>
<td><code>include_layers</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Include per-layer info</td>
</tr>
<tr>
<td><code>include_signatures</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Include I/O signatures</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Metrics</code> artifact with model architecture details (name, parameter counts, layer info).</p>
<p><strong>Decorator config:</strong> <code>inputs=["model"]</code>, <code>outputs=["inspection"]</code></p>
<hr />
<h3 id="pytorch-steps">PyTorch Steps</h3>
<p><strong>Module:</strong> <code>mlpotion.integrations.flowyml.pytorch</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">load_csv_data</span><span class="p">,</span>           <span class="c1"># CSV ‚Üí Dataset artifact (standard)</span>
    <span class="n">load_streaming_csv_data</span><span class="p">,</span> <span class="c1"># CSV ‚Üí Dataset artifact (chunked streaming)</span>
    <span class="n">train_model</span><span class="p">,</span>             <span class="c1"># Model + Dataset ‚Üí (Model, Metrics) artifacts</span>
    <span class="n">evaluate_model</span><span class="p">,</span>          <span class="c1"># Model + Dataset ‚Üí Metrics artifact</span>
    <span class="n">export_model</span><span class="p">,</span>            <span class="c1"># Model ‚Üí exported Model artifact</span>
    <span class="n">save_model</span><span class="p">,</span>              <span class="c1"># Model ‚Üí saved Model artifact</span>
    <span class="n">load_model</span><span class="p">,</span>              <span class="c1"># path ‚Üí Model artifact</span>
<span class="p">)</span>
</code></pre></div>
<h4 id="load_csv_data"><code>load_csv_data</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Glob pattern for CSV files</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>int</code></td>
<td><code>32</code></td>
<td>Batch size</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>Target column</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td><code>list[str] \| None</code></td>
<td><code>None</code></td>
<td>Columns to load</td>
</tr>
<tr>
<td><code>shuffle</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Shuffle data</td>
</tr>
<tr>
<td><code>num_workers</code></td>
<td><code>int</code></td>
<td><code>0</code></td>
<td>DataLoader workers</td>
</tr>
<tr>
<td><code>pin_memory</code></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Pin memory for faster GPU transfer</td>
</tr>
<tr>
<td><code>drop_last</code></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Drop last incomplete batch</td>
</tr>
<tr>
<td><code>dtype</code></td>
<td><code>str</code></td>
<td><code>"float32"</code></td>
<td>Tensor data type</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Dataset</code> artifact wrapping a PyTorch <code>DataLoader</code>.</p>
<p><strong>Decorator config:</strong> <code>outputs=["dataset"]</code>, <code>cache="code_hash"</code></p>
<h4 id="load_streaming_csv_data"><code>load_streaming_csv_data</code></h4>
<p>For datasets that <strong>don't fit in memory</strong> ‚Äî uses chunked reading:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Glob pattern for CSV files</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>int</code></td>
<td><code>32</code></td>
<td>Batch size</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>Target column</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td><code>list[str] \| None</code></td>
<td><code>None</code></td>
<td>Columns to load</td>
</tr>
<tr>
<td><code>num_workers</code></td>
<td><code>int</code></td>
<td><code>0</code></td>
<td>DataLoader workers</td>
</tr>
<tr>
<td><code>pin_memory</code></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Pin memory for GPU</td>
</tr>
<tr>
<td><code>chunksize</code></td>
<td><code>int</code></td>
<td><code>10000</code></td>
<td>Rows per chunk</td>
</tr>
<tr>
<td><code>dtype</code></td>
<td><code>str</code></td>
<td><code>"float32"</code></td>
<td>Tensor data type</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Dataset</code> artifact with <code>mode: "streaming"</code> metadata.</p>
<p><strong>Decorator config:</strong> <code>outputs=["dataset"]</code>, <code>cache=False</code> (streaming data changes)</p>
<blockquote>
<p><strong>üí° When to use:</strong> Choose <code>load_streaming_csv_data</code> when your dataset is too
large for memory. Choose <code>load_csv_data</code> for standard in-memory workflows.</p>
</blockquote>
<h4 id="train_model_1"><code>train_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>nn.Module</code></td>
<td>‚Äî</td>
<td>PyTorch model</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>DataLoader \| Dataset</code></td>
<td>‚Äî</td>
<td>Training data</td>
</tr>
<tr>
<td><code>epochs</code></td>
<td><code>int</code></td>
<td><code>10</code></td>
<td>Number of epochs</td>
</tr>
<tr>
<td><code>learning_rate</code></td>
<td><code>float</code></td>
<td><code>0.001</code></td>
<td>Learning rate</td>
</tr>
<tr>
<td><code>optimizer</code></td>
<td><code>str</code></td>
<td><code>"adam"</code></td>
<td>Optimizer: <code>"adam"</code>, <code>"sgd"</code>, <code>"adamw"</code></td>
</tr>
<tr>
<td><code>loss_fn</code></td>
<td><code>str</code></td>
<td><code>"mse"</code></td>
<td>Loss: <code>"mse"</code>, <code>"cross_entropy"</code></td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>str</code></td>
<td><code>"cpu"</code></td>
<td>Device: <code>"cpu"</code> or <code>"cuda"</code></td>
</tr>
<tr>
<td><code>validation_data</code></td>
<td><code>DataLoader \| Dataset \| None</code></td>
<td><code>None</code></td>
<td>Validation data</td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Log per-epoch metrics</td>
</tr>
<tr>
<td><code>max_batches_per_epoch</code></td>
<td><code>int \| None</code></td>
<td><code>None</code></td>
<td>Limit batches (debugging)</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>tuple[Model, Metrics]</code> ‚Äî Model via <code>Model.from_pytorch()</code> with auto-extracted module architecture.</p>
<p><strong>Decorator config:</strong> <code>inputs=["dataset"]</code>, <code>outputs=["model", "training_metrics"]</code>, <code>cache=False</code>, <code>retry=1</code></p>
<h4 id="evaluate_model_1"><code>evaluate_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>nn.Module \| Model</code></td>
<td>‚Äî</td>
<td>Trained model or Model artifact</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>DataLoader \| Dataset</code></td>
<td>‚Äî</td>
<td>Evaluation data</td>
</tr>
<tr>
<td><code>loss_fn</code></td>
<td><code>str</code></td>
<td><code>"mse"</code></td>
<td>Loss function</td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>str</code></td>
<td><code>"cpu"</code></td>
<td>Device</td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Log metrics</td>
</tr>
<tr>
<td><code>max_batches</code></td>
<td><code>int \| None</code></td>
<td><code>None</code></td>
<td>Limit batches</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Metrics</code> artifact.</p>
<p><strong>Decorator config:</strong> <code>inputs=["model", "dataset"]</code>, <code>outputs=["metrics"]</code>, <code>cache="input_hash"</code></p>
<h4 id="export_model_1"><code>export_model</code></h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model</code></td>
<td><code>nn.Module \| Model</code></td>
<td>‚Äî</td>
<td>Model to export</td>
</tr>
<tr>
<td><code>export_path</code></td>
<td><code>str</code></td>
<td>‚Äî</td>
<td>Destination path</td>
</tr>
<tr>
<td><code>export_format</code></td>
<td><code>str</code></td>
<td><code>"torchscript"</code></td>
<td>Format: <code>"torchscript"</code>, <code>"onnx"</code></td>
</tr>
<tr>
<td><code>sample_input</code></td>
<td><code>torch.Tensor \| None</code></td>
<td><code>None</code></td>
<td>Required for ONNX tracing</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Model</code> artifact with export metadata.</p>
<p><strong>Decorator config:</strong> <code>inputs=["model"]</code>, <code>outputs=["exported_model"]</code>, <code>cache="code_hash"</code></p>
<h4 id="save_model-load_model"><code>save_model</code> / <code>load_model</code></h4>
<p>Same contract as Keras ‚Äî accept raw or artifact objects, return <code>Model</code> artifacts.</p>
<hr />
<h3 id="tensorflow-steps">TensorFlow Steps</h3>
<p><strong>Module:</strong> <code>mlpotion.integrations.flowyml.tensorflow</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">load_data</span><span class="p">,</span>         <span class="c1"># CSV ‚Üí Dataset artifact</span>
    <span class="n">optimize_data</span><span class="p">,</span>     <span class="c1"># Dataset ‚Üí optimized Dataset artifact (TF-specific)</span>
    <span class="n">transform_data</span><span class="p">,</span>    <span class="c1"># Dataset + Model ‚Üí transformed Dataset artifact</span>
    <span class="n">train_model</span><span class="p">,</span>       <span class="c1"># Model + Dataset ‚Üí (Model, Metrics) artifacts</span>
    <span class="n">evaluate_model</span><span class="p">,</span>    <span class="c1"># Model + Dataset ‚Üí Metrics artifact</span>
    <span class="n">export_model</span><span class="p">,</span>      <span class="c1"># Model ‚Üí exported Model artifact</span>
    <span class="n">save_model</span><span class="p">,</span>        <span class="c1"># Model ‚Üí saved Model artifact</span>
    <span class="n">load_model</span><span class="p">,</span>        <span class="c1"># path ‚Üí Model artifact</span>
    <span class="n">inspect_model</span><span class="p">,</span>     <span class="c1"># Model ‚Üí Metrics artifact</span>
<span class="p">)</span>
</code></pre></div>
<h4 id="optimize_data-tf-exclusive"><code>optimize_data</code> <em>(TF-exclusive)</em></h4>
<p>Applies <code>tf.data.Dataset</code> optimization (prefetch, cache, shuffle) and returns
a new <code>Dataset</code> artifact with <strong>parent lineage</strong> linked to the input:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dataset</code></td>
<td><code>tf.data.Dataset \| Dataset</code></td>
<td>‚Äî</td>
<td>Input dataset</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>int</code></td>
<td><code>32</code></td>
<td>Batch size</td>
</tr>
<tr>
<td><code>shuffle_buffer_size</code></td>
<td><code>int \| None</code></td>
<td><code>None</code></td>
<td>Shuffle buffer size</td>
</tr>
<tr>
<td><code>prefetch</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Enable prefetching</td>
</tr>
<tr>
<td><code>cache</code></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Enable dataset caching</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>Dataset</code> artifact with <code>parent=</code> lineage.</p>
<p><strong>Decorator config:</strong> <code>inputs=["dataset"]</code>, <code>outputs=["optimized_dataset"]</code>, <code>cache="code_hash"</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_data</span><span class="p">,</span> <span class="n">optimize_data</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">optimized</span> <span class="o">=</span> <span class="n">optimize_data</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">prefetch</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Lineage is preserved</span>
<span class="nb">print</span><span class="p">(</span><span class="n">optimized</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>  <span class="c1"># Points back to `dataset`</span>
</code></pre></div>
<blockquote>
<p>The remaining TF steps (<code>load_data</code>, <code>train_model</code>, <code>evaluate_model</code>, etc.)
follow the same contract as Keras. The <code>train_model</code> step also auto-attaches
<code>FlowymlKerasCallback</code> when <code>experiment_name</code> is provided.</p>
</blockquote>
<hr />
<h3 id="the-flowymladapter-generic-steps">The <code>FlowyMLAdapter</code> (Generic Steps)</h3>
<p>For <strong>framework-agnostic</strong> or <strong>custom component</strong> scenarios, the
<code>FlowyMLAdapter</code> wraps any MLPotion protocol-compliant component into a
FlowyML step:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlowyMLAdapter</span>
</code></pre></div>
<h4 id="flowymladaptercreate_data_loader_step"><code>FlowyMLAdapter.create_data_loader_step()</code></h4>
<div class="highlight"><pre><span></span><code><span class="n">step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_data_loader_step</span><span class="p">(</span>
    <span class="n">loader</span><span class="p">,</span>                     <span class="c1"># Any DataLoader protocol implementation</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom_load&quot;</span><span class="p">,</span>         <span class="c1"># Step name (default: &quot;load_data&quot;)</span>
    <span class="n">cache</span><span class="o">=</span><span class="s2">&quot;code_hash&quot;</span><span class="p">,</span>          <span class="c1"># Caching strategy</span>
    <span class="n">retry</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>                    <span class="c1"># Retry count</span>
    <span class="n">resources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>             <span class="c1"># ResourceRequirements</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;env&quot;</span><span class="p">:</span> <span class="s2">&quot;staging&quot;</span><span class="p">},</span>    <span class="c1"># Metadata tags</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>Returns:</strong> A <code>Step</code> that calls <code>loader.load()</code> and wraps the result as a <code>Dataset</code> artifact.</p>
<h4 id="flowymladaptercreate_training_step"><code>FlowyMLAdapter.create_training_step()</code></h4>
<div class="highlight"><pre><span></span><code><span class="n">step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_training_step</span><span class="p">(</span>
    <span class="n">trainer</span><span class="p">,</span>                    <span class="c1"># Any ModelTrainer protocol implementation</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom_train&quot;</span><span class="p">,</span>        <span class="c1"># Step name (default: &quot;train_model&quot;)</span>
    <span class="n">cache</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>                <span class="c1"># Default: no caching for training</span>
    <span class="n">retry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                    <span class="c1"># Retry once on failure</span>
    <span class="n">resources</span><span class="o">=</span><span class="n">gpu_resources</span><span class="p">,</span>    <span class="c1"># GPU ResourceRequirements</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;train&quot;</span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>Returns:</strong> A <code>Step</code> that calls <code>trainer.train()</code> and wraps result as a <code>Model</code> artifact.</p>
<h4 id="flowymladaptercreate_evaluation_step"><code>FlowyMLAdapter.create_evaluation_step()</code></h4>
<div class="highlight"><pre><span></span><code><span class="n">step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_evaluation_step</span><span class="p">(</span>
    <span class="n">evaluator</span><span class="p">,</span>                  <span class="c1"># Any ModelEvaluator protocol implementation</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom_eval&quot;</span><span class="p">,</span>         <span class="c1"># Step name (default: &quot;evaluate_model&quot;)</span>
    <span class="n">cache</span><span class="o">=</span><span class="s2">&quot;input_hash&quot;</span><span class="p">,</span>         <span class="c1"># Default: cache by input hash</span>
    <span class="n">retry</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;eval&quot;</span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>Returns:</strong> A <code>Step</code> that calls <code>evaluator.evaluate()</code> and wraps result as a <code>Metrics</code> artifact.</p>
<h4 id="example-custom-component-pipeline">Example: Custom Component ‚Üí Pipeline</h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.keras.data.loaders</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVDataLoader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.keras.training.trainers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelTrainer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.keras.evaluation.evaluators</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelEvaluator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlowyMLAdapter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>

<span class="c1"># Wrap MLPotion components</span>
<span class="n">load_step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_data_loader_step</span><span class="p">(</span>
    <span class="n">CSVDataLoader</span><span class="p">(</span><span class="n">file_pattern</span><span class="o">=</span><span class="s2">&quot;data/*.csv&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">train_step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_training_step</span><span class="p">(</span><span class="n">ModelTrainer</span><span class="p">())</span>
<span class="n">eval_step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_evaluation_step</span><span class="p">(</span><span class="n">ModelEvaluator</span><span class="p">())</span>

<span class="c1"># Build a pipeline</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="s2">&quot;custom_pipeline&quot;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">load_step</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">train_step</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">eval_step</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="pipeline-templates">Pipeline Templates</h2>
<p>Each framework provides <strong>6 ready-to-use pipeline factories</strong>. All accept a
<code>Context</code> object for injecting hyperparameters and return a configured <code>Pipeline</code>
(or <code>dict</code> with pipeline + scheduler for scheduled pipelines).</p>
<h3 id="pipeline-design-principles">Pipeline Design Principles</h3>
<ol>
<li><strong>Context-driven</strong> ‚Äî all hyperparameters flow through a single <code>Context</code> object.</li>
<li><strong>DAG-resolved</strong> ‚Äî steps are wired by their <code>inputs</code>/<code>outputs</code> declarations.</li>
<li><strong>Configurable</strong> ‚Äî toggle caching, checkpointing, versioning via factory args.</li>
<li><strong>Composable</strong> ‚Äî use them as-is or as templates for your own pipelines.</li>
</ol>
<h3 id="pipeline-availability-matrix">Pipeline Availability Matrix</h3>
<table>
<thead>
<tr>
<th>Pipeline</th>
<th>Keras</th>
<th>PyTorch</th>
<th>TensorFlow</th>
</tr>
</thead>
<tbody>
<tr>
<td>Training</td>
<td><code>create_keras_training_pipeline</code></td>
<td><code>create_pytorch_training_pipeline</code></td>
<td><code>create_tf_training_pipeline</code></td>
</tr>
<tr>
<td>Full</td>
<td><code>create_keras_full_pipeline</code></td>
<td><code>create_pytorch_full_pipeline</code></td>
<td><code>create_tf_full_pipeline</code></td>
</tr>
<tr>
<td>Evaluation</td>
<td><code>create_keras_evaluation_pipeline</code></td>
<td><code>create_pytorch_evaluation_pipeline</code></td>
<td><code>create_tf_evaluation_pipeline</code></td>
</tr>
<tr>
<td>Export</td>
<td><code>create_keras_export_pipeline</code></td>
<td><code>create_pytorch_export_pipeline</code></td>
<td><code>create_tf_export_pipeline</code></td>
</tr>
<tr>
<td>Experiment</td>
<td><code>create_keras_experiment_pipeline</code></td>
<td><code>create_pytorch_experiment_pipeline</code></td>
<td><code>create_tf_experiment_pipeline</code></td>
</tr>
<tr>
<td>Scheduled</td>
<td><code>create_keras_scheduled_pipeline</code></td>
<td><code>create_pytorch_scheduled_pipeline</code></td>
<td><code>create_tf_scheduled_pipeline</code></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="1-training-pipeline">1. Training Pipeline</h3>
<p>Basic <strong>load ‚Üí train ‚Üí evaluate</strong> workflow.</p>
<p><strong>DAG:</strong>
<div class="highlight"><pre><span></span><code>load_data ‚Üí train_model ‚Üí evaluate_model
</code></pre></div></p>
<p><strong>Factory arguments:</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td><code>"&lt;fw&gt;_training"</code></td>
<td>Pipeline name</td>
</tr>
<tr>
<td><code>context</code></td>
<td><code>Context \| None</code></td>
<td><code>None</code></td>
<td>Hyperparameters</td>
</tr>
<tr>
<td><code>enable_cache</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Enable step caching</td>
</tr>
<tr>
<td><code>project_name</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>FlowyML project</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>str \| None</code></td>
<td><code>None</code></td>
<td>Pipeline version</td>
</tr>
</tbody>
</table>
<p><strong>Context parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td>‚úÖ</td>
<td>Path/glob to training CSV</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td>‚úÖ</td>
<td>Target column name</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td>‚Äî</td>
<td>Batch size (default: 32)</td>
</tr>
<tr>
<td><code>epochs</code></td>
<td>‚Äî</td>
<td>Training epochs (default: 10)</td>
</tr>
<tr>
<td><code>learning_rate</code></td>
<td>‚Äî</td>
<td>Learning rate (default: 0.001)</td>
</tr>
<tr>
<td><code>experiment_name</code></td>
<td>‚Äî</td>
<td>FlowyML experiment tracking name</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_training_pipeline</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_keras_training_pipeline</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;classification_v1&quot;</span><span class="p">,</span>
    <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;my_project&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p><strong>PyTorch equivalent</strong> includes additional context params: <code>optimizer</code>, <code>loss_fn</code>, <code>device</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pytorch_training_pipeline</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="o">=</span><span class="s2">&quot;cross_entropy&quot;</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_pytorch_training_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="2-full-pipeline">2. Full Pipeline</h3>
<p>Complete lifecycle with data transformation/optimization and export.</p>
<p><strong>DAG (Keras):</strong>
<div class="highlight"><pre><span></span><code>load_data ‚Üí transform_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model
</code></pre></div></p>
<p><strong>DAG (TensorFlow):</strong>
<div class="highlight"><pre><span></span><code>load_data ‚Üí optimize_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model
</code></pre></div></p>
<p><strong>DAG (PyTorch):</strong>
<div class="highlight"><pre><span></span><code>load_csv_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model ‚Üí save_model
</code></pre></div></p>
<p><strong>Additional factory arguments:</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>enable_checkpointing</code></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Resume on failure</td>
</tr>
</tbody>
</table>
<p><strong>Context parameters (superset):</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td>‚úÖ</td>
<td>Training data path</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td>‚úÖ</td>
<td>Target column</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td>‚Äî</td>
<td>Batch size</td>
</tr>
<tr>
<td><code>data_output_path</code></td>
<td>‚Äî</td>
<td>Keras: transformed data output path</td>
</tr>
<tr>
<td><code>shuffle_buffer_size</code></td>
<td>‚Äî</td>
<td>TF: shuffle buffer size</td>
</tr>
<tr>
<td><code>prefetch</code></td>
<td>‚Äî</td>
<td>TF: enable prefetching</td>
</tr>
<tr>
<td><code>epochs</code></td>
<td>‚Äî</td>
<td>Training epochs</td>
</tr>
<tr>
<td><code>learning_rate</code></td>
<td>‚Äî</td>
<td>Learning rate</td>
</tr>
<tr>
<td><code>experiment_name</code></td>
<td>‚Äî</td>
<td>Experiment tracking name</td>
</tr>
<tr>
<td><code>export_path</code></td>
<td>‚Äî</td>
<td>Export destination</td>
</tr>
<tr>
<td><code>export_format</code></td>
<td>‚Äî</td>
<td>Export format</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_full_pipeline</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">data_output_path</span><span class="o">=</span><span class="s2">&quot;data/transformed/&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;full-run&quot;</span><span class="p">,</span>
    <span class="n">export_path</span><span class="o">=</span><span class="s2">&quot;models/production/&quot;</span><span class="p">,</span>
    <span class="n">export_format</span><span class="o">=</span><span class="s2">&quot;keras&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_keras_full_pipeline</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">enable_checkpointing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="3-evaluation-pipeline">3. Evaluation Pipeline</h3>
<p>Evaluate an existing model against new data.</p>
<p><strong>DAG:</strong>
<div class="highlight"><pre><span></span><code>load_model ‚Üí load_data ‚Üí evaluate_model ‚Üí inspect_model
</code></pre></div></p>
<blockquote>
<p><strong>Note:</strong> PyTorch evaluation pipeline does not include <code>inspect_model</code>.</p>
</blockquote>
<p><strong>Context parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_path</code></td>
<td>‚úÖ</td>
<td>Path to saved model</td>
</tr>
<tr>
<td><code>file_path</code></td>
<td>‚úÖ</td>
<td>Evaluation data path</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td>‚úÖ</td>
<td>Target column</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td>‚Äî</td>
<td>Batch size</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_evaluation_pipeline</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;models/production/model.keras&quot;</span><span class="p">,</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/test.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_keras_evaluation_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<hr />
<h3 id="4-export-pipeline">4. Export Pipeline</h3>
<p>Convert and persist a model to a specified format.</p>
<p><strong>DAG:</strong>
<div class="highlight"><pre><span></span><code>load_model ‚Üí export_model, save_model
</code></pre></div></p>
<p><strong>Context parameters:</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model_path</code></td>
<td>‚úÖ</td>
<td>Path to trained model</td>
</tr>
<tr>
<td><code>export_path</code></td>
<td>‚úÖ</td>
<td>Export destination</td>
</tr>
<tr>
<td><code>export_format</code></td>
<td>‚Äî</td>
<td>Export format</td>
</tr>
<tr>
<td><code>save_path</code></td>
<td>‚Äî</td>
<td>Backup save path</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_export_pipeline</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;models/trained/model.keras&quot;</span><span class="p">,</span>
    <span class="n">export_path</span><span class="o">=</span><span class="s2">&quot;models/exported/&quot;</span><span class="p">,</span>
    <span class="n">export_format</span><span class="o">=</span><span class="s2">&quot;saved_model&quot;</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="s2">&quot;models/backup/model.keras&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_keras_export_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<blockquote>
<p><strong>PyTorch</strong> supports <code>export_format="torchscript"</code> or <code>"onnx"</code>.</p>
</blockquote>
<hr />
<h3 id="5-experiment-pipeline-conditional-deploy">5. Experiment Pipeline (Conditional Deploy)</h3>
<p>Train and <strong>auto-deploy only if metrics exceed a threshold</strong>.</p>
<p><strong>DAG:</strong>
<div class="highlight"><pre><span></span><code>load_data ‚Üí train_model ‚Üí evaluate_model
                                ‚Üì
                       [if metric ‚â• threshold]
                                ‚Üì
                       export_model ‚Üí save_model
</code></pre></div></p>
<p><strong>Additional factory arguments:</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>deploy_threshold</code></td>
<td><code>float</code></td>
<td><code>0.8</code></td>
<td>Minimum metric value</td>
</tr>
<tr>
<td><code>threshold_metric</code></td>
<td><code>str</code></td>
<td><code>"accuracy"</code></td>
<td>Metric to check</td>
</tr>
</tbody>
</table>
<p><strong>Pipeline features enabled:</strong>
- <code>enable_experiment_tracking=True</code>
- <code>enable_checkpointing=True</code>
- <code>enable_cache=False</code></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_experiment_pipeline</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;experiment-v1&quot;</span><span class="p">,</span>
    <span class="n">export_path</span><span class="o">=</span><span class="s2">&quot;models/production/&quot;</span><span class="p">,</span>
    <span class="n">save_path</span><span class="o">=</span><span class="s2">&quot;models/checkpoints/model.keras&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">create_keras_experiment_pipeline</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">deploy_threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span>
    <span class="n">threshold_metric</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<p>Under the hood, this uses FlowyML's <code>If</code> conditional flow:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.conditional</span><span class="w"> </span><span class="kn">import</span> <span class="n">If</span>

<span class="n">deploy_condition</span> <span class="o">=</span> <span class="n">If</span><span class="p">(</span>
    <span class="n">condition</span><span class="o">=</span><span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.85</span><span class="p">,</span>
    <span class="n">then_steps</span><span class="o">=</span><span class="p">[</span><span class="n">export_model</span><span class="p">,</span> <span class="n">save_model</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;deploy_if_accuracy_above_0.85&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">control_flows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deploy_condition</span><span class="p">)</span>
</code></pre></div>
<hr />
<h3 id="6-scheduled-pipeline">6. Scheduled Pipeline</h3>
<p>Periodic retraining with cron scheduling. Returns <strong>both</strong> the pipeline and
a configured scheduler:</p>
<p><strong>DAG:</strong>
<div class="highlight"><pre><span></span><code>load_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model
</code></pre></div></p>
<p><strong>Additional factory arguments:</strong></p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>schedule</code></td>
<td><code>str</code></td>
<td><code>"0 2 * * 0"</code></td>
<td>Cron expression</td>
</tr>
<tr>
<td><code>timezone</code></td>
<td><code>str</code></td>
<td><code>"UTC"</code></td>
<td>Timezone</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong> <code>dict[str, Any]</code> with <code>"pipeline"</code> and <code>"scheduler"</code> keys.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_scheduled_pipeline</span>

<span class="n">info</span> <span class="o">=</span> <span class="n">create_keras_scheduled_pipeline</span><span class="p">(</span>
    <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">schedule</span><span class="o">=</span><span class="s2">&quot;0 2 * * 0&quot;</span><span class="p">,</span>   <span class="c1"># Every Sunday at 2 AM</span>
    <span class="n">timezone</span><span class="o">=</span><span class="s2">&quot;UTC&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;pipeline&quot;</span><span class="p">]</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;scheduler&quot;</span><span class="p">]</span>

<span class="c1"># Run once now</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Or start the scheduler for automatic retraining</span>
<span class="n">scheduler</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>
<p><strong>Common cron patterns:</strong></p>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0 2 * * 0</code></td>
<td>Every Sunday at 2 AM</td>
</tr>
<tr>
<td><code>0 0 * * *</code></td>
<td>Every day at midnight</td>
</tr>
<tr>
<td><code>0 */6 * * *</code></td>
<td>Every 6 hours</td>
</tr>
<tr>
<td><code>0 0 1 * *</code></td>
<td>First day of every month</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="composing-custom-pipelines">Composing Custom Pipelines</h2>
<p>You can mix and match <strong>any steps</strong> from the integration to build your own
pipeline. Steps are not locked to their pipeline templates:</p>
<h3 id="example-custom-train-inspect-export-pipeline">Example: Custom Train ‚Üí Inspect ‚Üí Export Pipeline</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">load_data</span><span class="p">,</span>
    <span class="n">train_model</span><span class="p">,</span>
    <span class="n">inspect_model</span><span class="p">,</span>
    <span class="n">export_model</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">export_path</span><span class="o">=</span><span class="s2">&quot;models/prod/&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;train_inspect_export&quot;</span><span class="p">,</span>
    <span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
    <span class="n">enable_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">enable_checkpointing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Add only the steps you need</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">load_data</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">train_model</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">inspect_model</span><span class="p">)</span>   <span class="c1"># Inspect architecture after training</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">export_model</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<h3 id="example-adding-a-custom-step">Example: Adding a Custom Step</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.step</span><span class="w"> </span><span class="kn">import</span> <span class="n">step</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">Metrics</span>

<span class="nd">@step</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;compute_custom_metrics&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset&quot;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;custom_metrics&quot;</span><span class="p">],</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;custom&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_custom_metrics</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Your custom metric computation logic.&quot;&quot;&quot;</span>
    <span class="c1"># ... your code here ...</span>
    <span class="k">return</span> <span class="n">Metrics</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
        <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;f1_score&quot;</span><span class="p">:</span> <span class="mf">0.92</span><span class="p">,</span> <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="mf">0.95</span><span class="p">},</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom_metrics&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># Add it to any pipeline</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">compute_custom_metrics</span><span class="p">)</span>
</code></pre></div>
<h3 id="example-mixing-adapter-and-pre-built-steps">Example: Mixing Adapter and Pre-built Steps</h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">FlowyMLAdapter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_model</span><span class="p">,</span> <span class="n">evaluate_model</span>

<span class="c1"># Use MyCustomLoader with the adapter</span>
<span class="n">my_loader</span> <span class="o">=</span> <span class="n">MyCustomLoader</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s2">&quot;s3://bucket/data.csv&quot;</span><span class="p">)</span>
<span class="n">load_step</span> <span class="o">=</span> <span class="n">FlowyMLAdapter</span><span class="o">.</span><span class="n">create_data_loader_step</span><span class="p">(</span><span class="n">my_loader</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;s3_load&quot;</span><span class="p">)</span>

<span class="c1"># Combine with pre-built steps</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="s2">&quot;hybrid_pipeline&quot;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">load_step</span><span class="p">)</span>          <span class="c1"># Custom adapter step</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">train_model</span><span class="p">)</span>         <span class="c1"># Pre-built Keras step</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">evaluate_model</span><span class="p">)</span>      <span class="c1"># Pre-built Keras step</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
<hr />
<h2 id="artifact-types">Artifact Types</h2>
<h3 id="dataset">Dataset</h3>
<p>Wraps raw data (CSVSequence, DataLoader, tf.data.Dataset) with metadata:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>

<span class="c1"># Created automatically by load_data steps</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>                    <span class="c1"># Raw CSVSequence/DataLoader</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>     <span class="c1"># {&#39;source&#39;: &#39;...&#39;, &#39;batch_size&#39;: 32, ...}</span>
</code></pre></div>
<h3 id="model">Model</h3>
<p>Wraps trained models with auto-extracted architecture metadata:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">Model</span>

<span class="c1"># Created automatically by train_model, from_keras / from_pytorch</span>
<span class="n">model_asset</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_asset</span><span class="p">,</span> <span class="n">Model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_asset</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>                <span class="c1"># Raw keras.Model / nn.Module</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_asset</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span> <span class="c1"># Auto-extracted: layers, params, etc.</span>
</code></pre></div>
<p><strong>Auto-extraction methods:</strong>
- <code>Model.from_keras(model, ...)</code> ‚Äî extracts layers, parameters, optimizer info
- <code>Model.from_pytorch(model, ...)</code> ‚Äî extracts module architecture</p>
<h3 id="metrics">Metrics</h3>
<p>Wraps numeric metrics and training history:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">Metrics</span>

<span class="n">_</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">Metrics</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">))</span>          <span class="c1"># Access single metric</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>                      <span class="c1"># All metrics as dict</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>         <span class="c1"># Also stored in properties</span>
</code></pre></div>
<hr />
<h2 id="dag-wiring">DAG Wiring</h2>
<p>Steps declare <code>inputs</code> and <code>outputs</code> so FlowyML can auto-wire them:</p>
<div class="highlight"><pre><span></span><code>load_data            ‚Üí  outputs: [&quot;dataset&quot;]
transform_data       ‚Üí  inputs: [&quot;dataset&quot;],  outputs: [&quot;transformed&quot;]
optimize_data (TF)   ‚Üí  inputs: [&quot;dataset&quot;],  outputs: [&quot;optimized_dataset&quot;]
train_model          ‚Üí  inputs: [&quot;dataset&quot;],   outputs: [&quot;model&quot;, &quot;training_metrics&quot;]
evaluate_model       ‚Üí  inputs: [&quot;model&quot;, &quot;dataset&quot;],  outputs: [&quot;metrics&quot;]
export_model         ‚Üí  inputs: [&quot;model&quot;],     outputs: [&quot;exported_model&quot;]
save_model           ‚Üí  inputs: [&quot;model&quot;],     outputs: [&quot;saved_model&quot;]
load_model           ‚Üí  outputs: [&quot;model&quot;]
inspect_model        ‚Üí  inputs: [&quot;model&quot;],     outputs: [&quot;inspection&quot;]
</code></pre></div>
<p>When steps are added to a pipeline, FlowyML's DAG resolver automatically
connects matching output‚Üíinput names, creating a dependency graph.</p>
<h3 id="artifact-unwrapping">Artifact Unwrapping</h3>
<p>Steps also gracefully accept both <strong>raw objects</strong> and <strong>FlowyML artifacts</strong> as
input ‚Äî they unwrap artifacts internally before passing data to the underlying
MLPotion components:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Both of these work identically:</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">keras_model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">csv_sequence</span><span class="p">)</span>           <span class="c1"># raw objects</span>
<span class="n">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model_artifact</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dataset_artifact</span><span class="p">)</span>     <span class="c1"># FlowyML artifacts</span>
</code></pre></div>
<p>The unwrapping logic is:</p>
<div class="highlight"><pre><span></span><code><span class="n">raw_model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">data</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">Model</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span>
<span class="n">raw_data</span>  <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>
</code></pre></div>
<hr />
<h2 id="step-decorator-options">Step Decorator Options</h2>
<p>Every step in the integration uses FlowyML's <code>@step</code> decorator. Here is the
full set of options available to you when creating custom steps:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.step</span><span class="w"> </span><span class="kn">import</span> <span class="n">step</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.resources</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResourceRequirements</span><span class="p">,</span> <span class="n">GPUConfig</span>

<span class="nd">@step</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_step&quot;</span><span class="p">,</span>                          <span class="c1"># Unique step name</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">],</span>                      <span class="c1"># DAG input names</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;metrics&quot;</span><span class="p">],</span>            <span class="c1"># DAG output names</span>
    <span class="n">cache</span><span class="o">=</span><span class="s2">&quot;code_hash&quot;</span><span class="p">,</span>                       <span class="c1"># &quot;code_hash&quot;, &quot;input_hash&quot;, False</span>
    <span class="n">retry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>                                 <span class="c1"># Retry count on failure</span>
    <span class="n">resources</span><span class="o">=</span><span class="n">ResourceRequirements</span><span class="p">(</span>          <span class="c1"># Resource requirements</span>
        <span class="n">cpu</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="p">,</span>
        <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;16Gi&quot;</span><span class="p">,</span>
        <span class="n">gpu</span><span class="o">=</span><span class="n">GPUConfig</span><span class="p">(</span><span class="n">gpu_type</span><span class="o">=</span><span class="s2">&quot;nvidia-a100&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">execution_group</span><span class="o">=</span><span class="s2">&quot;training&quot;</span><span class="p">,</span>              <span class="c1"># Group steps on same node</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;framework&quot;</span><span class="p">:</span> <span class="s2">&quot;keras&quot;</span><span class="p">},</span>             <span class="c1"># Metadata tags</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_step</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Model</span><span class="p">,</span> <span class="n">Metrics</span><span class="p">]:</span>
    <span class="o">...</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>str</code></td>
<td>Unique step name within the pipeline</td>
</tr>
<tr>
<td><code>inputs</code></td>
<td><code>list[str]</code></td>
<td>DAG input artifact names</td>
</tr>
<tr>
<td><code>outputs</code></td>
<td><code>list[str]</code></td>
<td>DAG output artifact names</td>
</tr>
<tr>
<td><code>cache</code></td>
<td><code>bool \| str \| Callable</code></td>
<td>Caching strategy</td>
</tr>
<tr>
<td><code>retry</code></td>
<td><code>int</code></td>
<td>Number of retries on failure</td>
</tr>
<tr>
<td><code>resources</code></td>
<td><code>ResourceRequirements</code></td>
<td>CPU/memory/GPU requirements</td>
</tr>
<tr>
<td><code>execution_group</code></td>
<td><code>str</code></td>
<td>Group steps on the same compute node</td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code>dict[str, str]</code></td>
<td>Metadata tags for filtering/observability</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="caching-strategies">Caching Strategies</h2>
<table>
<thead>
<tr>
<th>Strategy</th>
<th>Value</th>
<th>Use Case</th>
<th>Used By</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Code hash</strong></td>
<td><code>"code_hash"</code></td>
<td>Skip if step code hasn't changed</td>
<td><code>load_data</code>, <code>export_model</code>, <code>load_model</code></td>
</tr>
<tr>
<td><strong>Input hash</strong></td>
<td><code>"input_hash"</code></td>
<td>Skip if inputs haven't changed</td>
<td><code>evaluate_model</code></td>
</tr>
<tr>
<td><strong>Disabled</strong></td>
<td><code>False</code></td>
<td>Always re-execute</td>
<td><code>train_model</code>, <code>streaming_load</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Rule of thumb:</strong> Data loading and export steps use <code>code_hash</code> since they're
deterministic. Evaluation uses <code>input_hash</code> since results depend on the model.
Training always re-runs because model weights are non-deterministic.</p>
</blockquote>
<hr />
<h2 id="gpu-resources-execution-groups">GPU Resources &amp; Execution Groups</h2>
<p>Steps ship <strong>without hardcoded resource requirements</strong> so they work out-of-the-box
on any hardware. When you need GPU scheduling, simply pass <code>resources</code> and
<code>execution_group</code> to the <code>@step</code> decorator ‚Äî FlowyML natively supports these:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.step</span><span class="w"> </span><span class="kn">import</span> <span class="n">step</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.resources</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResourceRequirements</span><span class="p">,</span> <span class="n">GPUConfig</span>

<span class="c1"># Option 1: Override when defining your own step</span>
<span class="nd">@step</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_train&quot;</span><span class="p">,</span>
    <span class="n">resources</span><span class="o">=</span><span class="n">ResourceRequirements</span><span class="p">(</span>
        <span class="n">cpu</span><span class="o">=</span><span class="s2">&quot;4&quot;</span><span class="p">,</span>
        <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;16Gi&quot;</span><span class="p">,</span>
        <span class="n">gpu</span><span class="o">=</span><span class="n">GPUConfig</span><span class="p">(</span><span class="n">gpu_type</span><span class="o">=</span><span class="s2">&quot;nvidia-a100&quot;</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
    <span class="p">),</span>
    <span class="n">execution_group</span><span class="o">=</span><span class="s2">&quot;training&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_train_model</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>

<span class="c1"># Option 2: Use the predefined step and configure resources at the pipeline level</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">train_model</span><span class="p">,</span> <span class="n">resources</span><span class="o">=</span><span class="n">ResourceRequirements</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>
</code></pre></div>
<p>This design gives you <strong>full flexibility</strong> ‚Äî the predefined steps remain
portable across CPU-only and GPU environments.</p>
<hr />
<h2 id="context-injection">Context Injection</h2>
<p>The <code>Context</code> object is the single entry-point for passing hyperparameters
to all steps in a pipeline. FlowyML resolves context values to matching
step parameters automatically:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.context</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="c1"># Data loading params ‚Üí resolved to load_data(file_path=, batch_size=, ...)</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>

    <span class="c1"># Training params ‚Üí resolved to train_model(epochs=, learning_rate=, ...)</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
    <span class="n">experiment_name</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span>

    <span class="c1"># Export params ‚Üí resolved to export_model(export_path=, export_format=, ...)</span>
    <span class="n">export_path</span><span class="o">=</span><span class="s2">&quot;models/prod/&quot;</span><span class="p">,</span>
    <span class="n">export_format</span><span class="o">=</span><span class="s2">&quot;keras&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<p><strong>How it works:</strong> when a pipeline runs, FlowyML inspects each step's function
signature and matches context keys to parameter names. Any matching key is
injected as a keyword argument.</p>
<h3 id="complete-context-parameter-reference">Complete Context Parameter Reference</h3>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Steps That Use It</th>
<th>Framework</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>file_path</code></td>
<td><code>load_data</code>, <code>load_csv_data</code></td>
<td>All</td>
</tr>
<tr>
<td><code>label_name</code></td>
<td><code>load_data</code>, <code>load_csv_data</code></td>
<td>All</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td><code>load_data</code>, <code>load_csv_data</code>, <code>optimize_data</code></td>
<td>All</td>
</tr>
<tr>
<td><code>column_names</code></td>
<td><code>load_data</code>, <code>load_csv_data</code></td>
<td>All</td>
</tr>
<tr>
<td><code>shuffle</code></td>
<td><code>load_data</code>, <code>load_csv_data</code></td>
<td>All</td>
</tr>
<tr>
<td><code>dtype</code></td>
<td><code>load_data</code>, <code>load_csv_data</code></td>
<td>All</td>
</tr>
<tr>
<td><code>num_workers</code></td>
<td><code>load_csv_data</code></td>
<td>PyTorch</td>
</tr>
<tr>
<td><code>pin_memory</code></td>
<td><code>load_csv_data</code></td>
<td>PyTorch</td>
</tr>
<tr>
<td><code>chunksize</code></td>
<td><code>load_streaming_csv_data</code></td>
<td>PyTorch</td>
</tr>
<tr>
<td><code>shuffle_buffer_size</code></td>
<td><code>optimize_data</code></td>
<td>TensorFlow</td>
</tr>
<tr>
<td><code>prefetch</code></td>
<td><code>optimize_data</code></td>
<td>TensorFlow</td>
</tr>
<tr>
<td><code>data_output_path</code></td>
<td><code>transform_data</code></td>
<td>Keras, TF</td>
</tr>
<tr>
<td><code>epochs</code></td>
<td><code>train_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>learning_rate</code></td>
<td><code>train_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>verbose</code></td>
<td><code>train_model</code>, <code>evaluate_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>optimizer</code></td>
<td><code>train_model</code></td>
<td>PyTorch</td>
</tr>
<tr>
<td><code>loss_fn</code></td>
<td><code>train_model</code>, <code>evaluate_model</code></td>
<td>PyTorch</td>
</tr>
<tr>
<td><code>device</code></td>
<td><code>train_model</code>, <code>evaluate_model</code>, <code>load_model</code></td>
<td>PyTorch</td>
</tr>
<tr>
<td><code>experiment_name</code></td>
<td><code>train_model</code></td>
<td>Keras, TF</td>
</tr>
<tr>
<td><code>project</code></td>
<td><code>train_model</code></td>
<td>Keras, TF</td>
</tr>
<tr>
<td><code>log_model</code></td>
<td><code>train_model</code></td>
<td>Keras, TF</td>
</tr>
<tr>
<td><code>model_path</code></td>
<td><code>load_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>export_path</code></td>
<td><code>export_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>export_format</code></td>
<td><code>export_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>save_path</code></td>
<td><code>save_model</code></td>
<td>All</td>
</tr>
<tr>
<td><code>sample_input</code></td>
<td><code>export_model</code></td>
<td>PyTorch</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="advanced-patterns">Advanced Patterns</h2>
<h3 id="cross-framework-reuse">Cross-Framework Reuse</h3>
<p>All pipeline templates follow the <strong>same factory signature</strong>, making it trivial
to swap frameworks:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># The same Context works across frameworks</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span>
    <span class="n">file_path</span><span class="o">=</span><span class="s2">&quot;data/train.csv&quot;</span><span class="p">,</span>
    <span class="n">label_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Swap just the import</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_keras_training_pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.pytorch</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pytorch_training_pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_tf_training_pipeline</span>

<span class="c1"># All three work with the same context</span>
<span class="n">keras_pipe</span> <span class="o">=</span> <span class="n">create_keras_training_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="n">pytorch_pipe</span> <span class="o">=</span> <span class="n">create_pytorch_training_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
<span class="n">tf_pipe</span> <span class="o">=</span> <span class="n">create_tf_training_pipeline</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="n">ctx</span><span class="p">)</span>
</code></pre></div>
<h3 id="combining-steps-from-different-frameworks">Combining Steps from Different Frameworks</h3>
<p>While not common, you can mix steps from different framework modules
in a single pipeline when the artifact types are compatible:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.pipeline</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_data</span><span class="p">,</span> <span class="n">train_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">inspect_model</span>

<span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="s2">&quot;multi_step&quot;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">load_data</span><span class="p">)</span>         <span class="c1"># Keras data loading</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">train_model</span><span class="p">)</span>       <span class="c1"># Keras training</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">add_step</span><span class="p">(</span><span class="n">inspect_model</span><span class="p">)</span>     <span class="c1"># Keras inspection</span>
<span class="c1"># All compatible because they share the same artifact types</span>
</code></pre></div>
<h3 id="building-a-custom-step-from-mlpotion-components">Building a Custom Step from MLPotion Components</h3>
<p>Create a new FlowyML step from scratch using any MLPotion component:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.step</span><span class="w"> </span><span class="kn">import</span> <span class="n">step</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flowyml</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Metrics</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.keras.data.loaders</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVDataLoader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.frameworks.keras.training.trainers</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModelTrainer</span>

<span class="nd">@step</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;custom_train_with_augmentation&quot;</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;metrics&quot;</span><span class="p">],</span>
    <span class="n">retry</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">tags</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stage&quot;</span><span class="p">:</span> <span class="s2">&quot;training&quot;</span><span class="p">,</span> <span class="s2">&quot;augmentation&quot;</span><span class="p">:</span> <span class="s2">&quot;enabled&quot;</span><span class="p">},</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">custom_train_with_augmentation</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dataset</span><span class="p">,</span>
    <span class="n">epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">augment</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Model</span><span class="p">,</span> <span class="n">Metrics</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom training step with data augmentation.&quot;&quot;&quot;</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">)</span> <span class="k">else</span> <span class="n">data</span>

    <span class="k">if</span> <span class="n">augment</span><span class="p">:</span>
        <span class="c1"># Your custom augmentation logic</span>
        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">apply_augmentation</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="n">trainer</span> <span class="o">=</span> <span class="n">ModelTrainer</span><span class="p">()</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">config</span><span class="o">=...</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">Model</span><span class="o">.</span><span class="n">from_keras</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;augmented_model&quot;</span><span class="p">),</span>
        <span class="n">Metrics</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">metrics</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;aug_metrics&quot;</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div>
<h3 id="conditional-flows">Conditional Flows</h3>
<p>Use FlowyML's <code>If</code> to add conditional logic to any pipeline:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flowyml.core.conditional</span><span class="w"> </span><span class="kn">import</span> <span class="n">If</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mlpotion.integrations.flowyml.keras</span><span class="w"> </span><span class="kn">import</span> <span class="n">export_model</span><span class="p">,</span> <span class="n">save_model</span>

<span class="c1"># Deploy only if loss is below 0.1</span>
<span class="n">deploy_condition</span> <span class="o">=</span> <span class="n">If</span><span class="p">(</span>
    <span class="n">condition</span><span class="o">=</span><span class="k">lambda</span> <span class="n">metrics</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">then_steps</span><span class="o">=</span><span class="p">[</span><span class="n">export_model</span><span class="p">,</span> <span class="n">save_model</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;deploy_if_loss_low&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">control_flows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">deploy_condition</span><span class="p">)</span>
</code></pre></div>
<h3 id="lineage-tracking">Lineage Tracking</h3>
<p>Steps that transform data automatically link to their parent via
FlowyML's <code>parent=</code> parameter:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># transform_data and optimize_data both preserve lineage</span>
<span class="n">transformed</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">output_data</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transformed&quot;</span><span class="p">,</span>
    <span class="n">parent</span><span class="o">=</span><span class="n">input_dataset</span><span class="p">,</span>    <span class="c1"># ‚Üê Lineage link</span>
<span class="p">)</span>

<span class="c1"># Query lineage</span>
<span class="nb">print</span><span class="p">(</span><span class="n">transformed</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>   <span class="c1"># ‚Üí original Dataset reference</span>
</code></pre></div>
<hr />
<h2 id="framework-specific-notes">Framework-Specific Notes</h2>
<h3 id="keras">Keras</h3>
<ul>
<li><code>FlowymlKerasCallback</code> auto-captures all training metrics live to the FlowyML dashboard</li>
<li>Supports <code>experiment_name</code> and <code>project</code> parameters for experiment tracking</li>
<li><code>Model.from_keras()</code> auto-extracts layer counts, parameter counts, and optimizer info</li>
<li>Includes <code>transform_data</code> step for model-based data transformation with CSV output</li>
<li>Full pipeline includes: <code>load_data ‚Üí transform_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model</code></li>
</ul>
<h3 id="pytorch">PyTorch</h3>
<ul>
<li>Supports both <code>CSVDataset</code> and <code>StreamingCSVDataset</code> for memory-efficient loading</li>
<li><code>Model.from_pytorch()</code> auto-extracts module architecture</li>
<li>Export supports <code>torchscript</code> and <code>onnx</code> formats with <code>sample_input</code> for tracing</li>
<li>Configurable <code>device</code> parameter (<code>"cpu"</code> or <code>"cuda"</code>) on train and eval steps</li>
<li>Optimizer selection: <code>"adam"</code>, <code>"sgd"</code>, <code>"adamw"</code></li>
<li>Full pipeline: <code>load_csv_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model ‚Üí save_model</code></li>
</ul>
<h3 id="tensorflow">TensorFlow</h3>
<ul>
<li>Includes <code>optimize_data</code> step for <code>tf.data.Dataset</code> optimization (prefetch, cache, shuffle)</li>
<li>Includes <code>transform_data</code> step for model-based data transformation with CSV output</li>
<li>Uses <code>Model.from_keras()</code> since TF models are Keras models under the hood</li>
<li>Full pipeline: <code>load_data ‚Üí optimize_data ‚Üí train_model ‚Üí evaluate_model ‚Üí export_model</code></li>
</ul>
<hr />
<h2 id="api-reference">API Reference</h2>
<h3 id="steps-by-framework">Steps by Framework</h3>
<h4 id="keras-mlpotionintegrationsflowymlkeras">Keras (<code>mlpotion.integrations.flowyml.keras</code>)</h4>
<table>
<thead>
<tr>
<th>Step</th>
<th>Inputs</th>
<th>Outputs</th>
<th>Cache</th>
<th>Retry</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>load_data</code></td>
<td>‚Äî</td>
<td><code>dataset</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>transform_data</code></td>
<td><code>dataset</code></td>
<td><code>transformed</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>train_model</code></td>
<td><code>dataset</code></td>
<td><code>model</code>, <code>training_metrics</code></td>
<td><code>False</code></td>
<td>1</td>
</tr>
<tr>
<td><code>evaluate_model</code></td>
<td><code>model</code>, <code>dataset</code></td>
<td><code>metrics</code></td>
<td><code>input_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>export_model</code></td>
<td><code>model</code></td>
<td><code>exported_model</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>save_model</code></td>
<td><code>model</code></td>
<td><code>saved_model</code></td>
<td>‚Äî</td>
<td>0</td>
</tr>
<tr>
<td><code>load_model</code></td>
<td>‚Äî</td>
<td><code>model</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>inspect_model</code></td>
<td><code>model</code></td>
<td><code>inspection</code></td>
<td>‚Äî</td>
<td>0</td>
</tr>
</tbody>
</table>
<h4 id="pytorch-mlpotionintegrationsflowymlpytorch">PyTorch (<code>mlpotion.integrations.flowyml.pytorch</code>)</h4>
<table>
<thead>
<tr>
<th>Step</th>
<th>Inputs</th>
<th>Outputs</th>
<th>Cache</th>
<th>Retry</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>load_csv_data</code></td>
<td>‚Äî</td>
<td><code>dataset</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>load_streaming_csv_data</code></td>
<td>‚Äî</td>
<td><code>dataset</code></td>
<td><code>False</code></td>
<td>0</td>
</tr>
<tr>
<td><code>train_model</code></td>
<td><code>dataset</code></td>
<td><code>model</code>, <code>training_metrics</code></td>
<td><code>False</code></td>
<td>1</td>
</tr>
<tr>
<td><code>evaluate_model</code></td>
<td><code>model</code>, <code>dataset</code></td>
<td><code>metrics</code></td>
<td><code>input_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>export_model</code></td>
<td><code>model</code></td>
<td><code>exported_model</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>save_model</code></td>
<td><code>model</code></td>
<td><code>saved_model</code></td>
<td>‚Äî</td>
<td>0</td>
</tr>
<tr>
<td><code>load_model</code></td>
<td>‚Äî</td>
<td><code>model</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
</tbody>
</table>
<h4 id="tensorflow-mlpotionintegrationsflowymltensorflow">TensorFlow (<code>mlpotion.integrations.flowyml.tensorflow</code>)</h4>
<table>
<thead>
<tr>
<th>Step</th>
<th>Inputs</th>
<th>Outputs</th>
<th>Cache</th>
<th>Retry</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>load_data</code></td>
<td>‚Äî</td>
<td><code>dataset</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>optimize_data</code></td>
<td><code>dataset</code></td>
<td><code>optimized_dataset</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>transform_data</code></td>
<td><code>dataset</code></td>
<td><code>transformed</code></td>
<td>‚Äî</td>
<td>0</td>
</tr>
<tr>
<td><code>train_model</code></td>
<td><code>dataset</code></td>
<td><code>model</code>, <code>training_metrics</code></td>
<td><code>False</code></td>
<td>1</td>
</tr>
<tr>
<td><code>evaluate_model</code></td>
<td><code>model</code>, <code>dataset</code></td>
<td><code>metrics</code></td>
<td><code>input_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>export_model</code></td>
<td><code>model</code></td>
<td><code>exported_model</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>save_model</code></td>
<td><code>model</code></td>
<td><code>saved_model</code></td>
<td>‚Äî</td>
<td>0</td>
</tr>
<tr>
<td><code>load_model</code></td>
<td>‚Äî</td>
<td><code>model</code></td>
<td><code>code_hash</code></td>
<td>0</td>
</tr>
<tr>
<td><code>inspect_model</code></td>
<td><code>model</code></td>
<td><code>inspection</code></td>
<td>‚Äî</td>
<td>0</td>
</tr>
</tbody>
</table>
<h4 id="generic-adapter-mlpotionintegrationsflowymlflowymladapter">Generic Adapter (<code>mlpotion.integrations.flowyml.FlowyMLAdapter</code>)</h4>
<table>
<thead>
<tr>
<th>Factory Method</th>
<th>Wraps</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>create_data_loader_step(loader)</code></td>
<td><code>DataLoader</code> protocol</td>
<td><code>Dataset</code> artifact</td>
</tr>
<tr>
<td><code>create_training_step(trainer)</code></td>
<td><code>ModelTrainer</code> protocol</td>
<td><code>Model</code> artifact</td>
</tr>
<tr>
<td><code>create_evaluation_step(evaluator)</code></td>
<td><code>ModelEvaluator</code> protocol</td>
<td><code>Metrics</code> artifact</td>
</tr>
</tbody>
</table>
<h3 id="pipelines-by-framework">Pipelines by Framework</h3>
<table>
<thead>
<tr>
<th>Pipeline Factory</th>
<th>DAG</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>create_&lt;fw&gt;_training_pipeline</code></td>
<td>load ‚Üí train ‚Üí eval</td>
<td><code>Pipeline</code></td>
</tr>
<tr>
<td><code>create_&lt;fw&gt;_full_pipeline</code></td>
<td>load ‚Üí [transform|optimize] ‚Üí train ‚Üí eval ‚Üí export</td>
<td><code>Pipeline</code></td>
</tr>
<tr>
<td><code>create_&lt;fw&gt;_evaluation_pipeline</code></td>
<td>load_model ‚Üí load_data ‚Üí eval [‚Üí inspect]</td>
<td><code>Pipeline</code></td>
</tr>
<tr>
<td><code>create_&lt;fw&gt;_export_pipeline</code></td>
<td>load_model ‚Üí export + save</td>
<td><code>Pipeline</code></td>
</tr>
<tr>
<td><code>create_&lt;fw&gt;_experiment_pipeline</code></td>
<td>load ‚Üí train ‚Üí eval ‚Üí [if metric ‚â• threshold] ‚Üí export + save</td>
<td><code>Pipeline</code></td>
</tr>
<tr>
<td><code>create_&lt;fw&gt;_scheduled_pipeline</code></td>
<td>load ‚Üí train ‚Üí eval ‚Üí export (+ scheduler)</td>
<td><code>dict</code></td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/UnicoLab/MLPotion" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/mlpotion/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../assets/js/fix-image-paths.js"></script>
      
    
  </body>
</html>